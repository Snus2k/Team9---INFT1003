/*! For license information please see track.js.LICENSE.txt */
!function(){var e={278:function(e,t,n){"use strict";var i=n(922),r=Object.prototype.toString,o=Object.prototype.hasOwnProperty,s=function(e,t,n){for(var i=0,r=e.length;i<r;i++)o.call(e,i)&&(null==n?t(e[i],i,e):t.call(n,e[i],i,e))},a=function(e,t,n){for(var i=0,r=e.length;i<r;i++)null==n?t(e.charAt(i),i,e):t.call(n,e.charAt(i),i,e)},l=function(e,t,n){for(var i in e)o.call(e,i)&&(null==n?t(e[i],i,e):t.call(n,e[i],i,e))};e.exports=function(e,t,n){if(!i(t))throw new TypeError("iterator must be a function");var o;arguments.length>=3&&(o=n),"[object Array]"===r.call(e)?s(e,t,o):"string"==typeof e?a(e,t,o):l(e,t,o)}},922:function(e){"use strict";var t,n,i=Function.prototype.toString,r="object"==typeof Reflect&&null!==Reflect&&Reflect.apply;if("function"==typeof r&&"function"==typeof Object.defineProperty)try{t=Object.defineProperty({},"length",{get:function(){throw n}}),n={},r((function(){throw 42}),null,t)}catch(e){e!==n&&(r=null)}else r=null;var o=/^\s*class\b/,s=function(e){try{var t=i.call(e);return o.test(t)}catch(e){return!1}},a=Object.prototype.toString,l="function"==typeof Symbol&&!!Symbol.toStringTag,u="object"==typeof document&&void 0===document.all&&void 0!==document.all?document.all:{};e.exports=r?function(e){if(e===u)return!0;if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;if("function"==typeof e&&!e.prototype)return!0;try{r(e,null,t)}catch(e){if(e!==n)return!1}return!s(e)}:function(e){if(e===u)return!0;if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;if("function"==typeof e&&!e.prototype)return!0;if(l)return function(e){try{return!s(e)&&(i.call(e),!0)}catch(e){return!1}}(e);if(s(e))return!1;var t=a.call(e);return"[object Function]"===t||"[object GeneratorFunction]"===t}},23:function(e,t,n){var i;e=n.nmd(e),function(){"use strict";var r={function:!0,object:!0},o=r[typeof window]&&window||this,s=r[typeof t]&&t,a=r.object&&e&&!e.nodeType&&e,l=s&&a&&"object"==typeof n.g&&n.g;!l||l.global!==l&&l.window!==l&&l.self!==l||(o=l);var u=Math.pow(2,53)-1,c=/\bOpera/,h=Object.prototype,d=h.hasOwnProperty,f=h.toString;function p(e){return(e=String(e)).charAt(0).toUpperCase()+e.slice(1)}function v(e){return e=w(e),/^(?:webOS|i(?:OS|P))/.test(e)?e:p(e)}function m(e,t){for(var n in e)d.call(e,n)&&t(e[n],n,e)}function g(e){return null==e?p(e):f.call(e).slice(8,-1)}function y(e){return String(e).replace(/([ -])(?!$)/g,"$1?")}function b(e,t){var n=null;return function(e,t){var n=-1,i=e?e.length:0;if("number"==typeof i&&i>-1&&i<=u)for(;++n<i;)t(e[n],n,e);else m(e,t)}(e,(function(i,r){n=t(n,i,r,e)})),n}function w(e){return String(e).replace(/^ +| +$/g,"")}var S=function e(t){var n=o,i=t&&"object"==typeof t&&"String"!=g(t);i&&(n=t,t=null);var r=n.navigator||{},s=r.userAgent||"";t||(t=s);var a,l,u,h,d,p=i?!!r.likeChrome:/\bChrome\b/.test(t)&&!/internal|\n/i.test(f.toString()),S="Object",E=i?S:"ScriptBridgingProxyObject",k=i?S:"Environment",O=i&&n.java?"JavaPackage":g(n.java),I=i?S:"RuntimeObject",R=/\bJava/.test(O)&&n.java,x=R&&g(n.environment)==k,C=R?"a":"α",N=R?"b":"β",_=n.document||{},A=n.operamini||n.opera,T=c.test(T=i&&A?A["[[Class]]"]:g(A))?T:A=null,D=t,L=[],M=null,P=t==s,j=P&&A&&"function"==typeof A.version&&A.version(),V=b([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"],(function(e,n){return e||RegExp("\\b"+(n.pattern||y(n))+"\\b","i").exec(t)&&(n.label||n)})),H=function(e){return b(e,(function(e,n){return e||RegExp("\\b"+(n.pattern||y(n))+"\\b","i").exec(t)&&(n.label||n)}))}(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"(?:Edge|Edg|EdgA|EdgiOS)"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Vivaldi","Waterfox","WebPositive",{label:"Yandex Browser",pattern:"YaBrowser"},{label:"UC Browser",pattern:"UCBrowser"},"Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chromium","Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),U=B([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),F=function(e){return b(e,(function(e,n,i){return e||(n[U]||n[/^[a-z]+(?: +[a-z]+\b)*/i.exec(U)]||RegExp("\\b"+y(i)+"(?:\\b|\\w*\\d)","i").exec(t))&&i}))}({Apple:{iPad:1,iPhone:1,iPod:1},Alcatel:{},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},Huawei:{},Lenovo:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Oppo:{},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1},Xiaomi:{Mi:1,Redmi:1}}),q=function(e){return b(e,(function(e,n){var i=n.pattern||y(n);return!e&&(e=RegExp("\\b"+i+"(?:/[\\d.]+|[ \\w.]*)","i").exec(t))&&(e=function(e,t,n){var i={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return t&&n&&/^Win/i.test(e)&&!/^Windows Phone /i.test(e)&&(i=i[/[\d.]+$/.exec(e)])&&(e="Windows "+i),e=String(e),t&&n&&(e=e.replace(RegExp(t,"i"),n)),v(e.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}(e,i,n.label||n)),e}))}(["Windows Phone","KaiOS","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian",{label:"DragonFly BSD",pattern:"DragonFly"},"Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);function B(e){return b(e,(function(e,n){var i=n.pattern||y(n);return!e&&(e=RegExp("\\b"+i+" *\\d+[.\\w_]*","i").exec(t)||RegExp("\\b"+i+" *\\w+-[\\w]*","i").exec(t)||RegExp("\\b"+i+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(t))&&((e=String(n.label&&!RegExp(i,"i").test(n.label)?n.label:e).split("/"))[1]&&!/[\d.]+/.test(e[0])&&(e[0]+=" "+e[1]),n=n.label||n,e=v(e[0].replace(RegExp(i,"i"),n).replace(RegExp("; *(?:"+n+"[_-])?","i")," ").replace(RegExp("("+n+")[-_.]?(\\w)","i"),"$1 $2"))),e}))}function W(e){return b(e,(function(e,n){return e||(RegExp(n+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(t)||0)[1]||null}))}if(V&&(V=[V]),/\bAndroid\b/.test(q)&&!U&&(a=/\bAndroid[^;]*;(.*?)(?:Build|\) AppleWebKit)\b/i.exec(t))&&(U=w(a[1]).replace(/^[a-z]{2}-[a-z]{2};\s*/i,"")||null),F&&!U?U=B([F]):F&&U&&(U=U.replace(RegExp("^("+y(F)+")[-_.\\s]","i"),F+" ").replace(RegExp("^("+y(F)+")[-_.]?(\\w)","i"),F+" $2")),(a=/\bGoogle TV\b/.exec(U))&&(U=a[0]),/\bSimulator\b/i.test(t)&&(U=(U?U+" ":"")+"Simulator"),"Opera Mini"==H&&/\bOPiOS\b/.test(t)&&L.push("running in Turbo/Uncompressed mode"),"IE"==H&&/\blike iPhone OS\b/.test(t)?(F=(a=e(t.replace(/like iPhone OS/,""))).manufacturer,U=a.product):/^iP/.test(U)?(H||(H="Safari"),q="iOS"+((a=/ OS ([\d_]+)/i.exec(t))?" "+a[1].replace(/_/g,"."):"")):"Konqueror"==H&&/^Linux\b/i.test(q)?q="Kubuntu":F&&"Google"!=F&&(/Chrome/.test(H)&&!/\bMobile Safari\b/i.test(t)||/\bVita\b/.test(U))||/\bAndroid\b/.test(q)&&/^Chrome/.test(H)&&/\bVersion\//i.test(t)?(H="Android Browser",q=/\bAndroid\b/.test(q)?q:"Android"):"Silk"==H?(/\bMobi/i.test(t)||(q="Android",L.unshift("desktop mode")),/Accelerated *= *true/i.test(t)&&L.unshift("accelerated")):"UC Browser"==H&&/\bUCWEB\b/.test(t)?L.push("speed mode"):"PaleMoon"==H&&(a=/\bFirefox\/([\d.]+)\b/.exec(t))?L.push("identifying as Firefox "+a[1]):"Firefox"==H&&(a=/\b(Mobile|Tablet|TV)\b/i.exec(t))?(q||(q="Firefox OS"),U||(U=a[1])):!H||(a=!/\bMinefield\b/i.test(t)&&/\b(?:Firefox|Safari)\b/.exec(H))?(H&&!U&&/[\/,]|^[^(]+?\)/.test(t.slice(t.indexOf(a+"/")+8))&&(H=null),(a=U||F||q)&&(U||F||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(q))&&(H=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(q)?q:a)+" Browser")):"Electron"==H&&(a=(/\bChrome\/([\d.]+)\b/.exec(t)||0)[1])&&L.push("Chromium "+a),j||(j=W(["(?:Cloud9|CriOS|CrMo|Edge|Edg|EdgA|EdgiOS|FxiOS|HeadlessChrome|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$)|UCBrowser|YaBrowser)","Version",y(H),"(?:Firefox|Minefield|NetFront)"])),(a=("iCab"==V&&parseFloat(j)>3?"WebKit":/\bOpera\b/.test(H)&&(/\bOPR\b/.test(t)?"Blink":"Presto"))||/\b(?:Midori|Nook|Safari)\b/i.test(t)&&!/^(?:Trident|EdgeHTML)$/.test(V)&&"WebKit"||!V&&/\bMSIE\b/i.test(t)&&("Mac OS"==q?"Tasman":"Trident")||"WebKit"==V&&/\bPlayStation\b(?! Vita\b)/i.test(H)&&"NetFront")&&(V=[a]),"IE"==H&&(a=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(t)||0)[1])?(H+=" Mobile",q="Windows Phone "+(/\+$/.test(a)?a:a+".x"),L.unshift("desktop mode")):/\bWPDesktop\b/i.test(t)?(H="IE Mobile",q="Windows Phone 8.x",L.unshift("desktop mode"),j||(j=(/\brv:([\d.]+)/.exec(t)||0)[1])):"IE"!=H&&"Trident"==V&&(a=/\brv:([\d.]+)/.exec(t))&&(H&&L.push("identifying as "+H+(j?" "+j:"")),H="IE",j=a[1]),P){if(h="global",d=null!=(u=n)?typeof u[h]:"number",/^(?:boolean|number|string|undefined)$/.test(d)||"object"==d&&!u[h])g(a=n.runtime)==E?(H="Adobe AIR",q=a.flash.system.Capabilities.os):g(a=n.phantom)==I?(H="PhantomJS",j=(a=a.version||null)&&a.major+"."+a.minor+"."+a.patch):"number"==typeof _.documentMode&&(a=/\bTrident\/(\d+)/i.exec(t))?(j=[j,_.documentMode],(a=+a[1]+4)!=j[1]&&(L.push("IE "+j[1]+" mode"),V&&(V[1]=""),j[1]=a),j="IE"==H?String(j[1].toFixed(1)):j[0]):"number"==typeof _.documentMode&&/^(?:Chrome|Firefox)\b/.test(H)&&(L.push("masking as "+H+" "+j),H="IE",j="11.0",V=["Trident"],q="Windows");else if(R&&(D=(a=R.lang.System).getProperty("os.arch"),q=q||a.getProperty("os.name")+" "+a.getProperty("os.version")),x){try{j=n.require("ringo/engine").version.join("."),H="RingoJS"}catch(e){(a=n.system)&&a.global.system==n.system&&(H="Narwhal",q||(q=a[0].os||null))}H||(H="Rhino")}else"object"==typeof n.process&&!n.process.browser&&(a=n.process)&&("object"==typeof a.versions&&("string"==typeof a.versions.electron?(L.push("Node "+a.versions.node),H="Electron",j=a.versions.electron):"string"==typeof a.versions.nw&&(L.push("Chromium "+j,"Node "+a.versions.node),H="NW.js",j=a.versions.nw)),H||(H="Node.js",D=a.arch,q=a.platform,j=(j=/[\d.]+/.exec(a.version))?j[0]:null));q=q&&v(q)}if(j&&(a=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(j)||/(?:alpha|beta)(?: ?\d)?/i.exec(t+";"+(P&&r.appMinorVersion))||/\bMinefield\b/i.test(t)&&"a")&&(M=/b/i.test(a)?"beta":"alpha",j=j.replace(RegExp(a+"\\+?$"),"")+("beta"==M?N:C)+(/\d+\+?/.exec(a)||"")),"Fennec"==H||"Firefox"==H&&/\b(?:Android|Firefox OS|KaiOS)\b/.test(q))H="Firefox Mobile";else if("Maxthon"==H&&j)j=j.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(U))"Xbox 360"==U&&(q=null),"Xbox 360"==U&&/\bIEMobile\b/.test(t)&&L.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(H)&&(!H||U||/Browser|Mobi/.test(H))||"Windows CE"!=q&&!/Mobi/i.test(t))if("IE"==H&&P)try{null===n.external&&L.unshift("platform preview")}catch(e){L.unshift("embedded")}else(/\bBlackBerry\b/.test(U)||/\bBB10\b/.test(t))&&(a=(RegExp(U.replace(/ +/g," *")+"/([.\\d]+)","i").exec(t)||0)[1]||j)?(q=((a=[a,/BB10/.test(t)])[1]?(U=null,F="BlackBerry"):"Device Software")+" "+a[0],j=null):this!=m&&"Wii"!=U&&(P&&A||/Opera/.test(H)&&/\b(?:MSIE|Firefox)\b/i.test(t)||"Firefox"==H&&/\bOS X (?:\d+\.){2,}/.test(q)||"IE"==H&&(q&&!/^Win/.test(q)&&j>5.5||/\bWindows XP\b/.test(q)&&j>8||8==j&&!/\bTrident\b/.test(t)))&&!c.test(a=e.call(m,t.replace(c,"")+";"))&&a.name&&(a="ing as "+a.name+((a=a.version)?" "+a:""),c.test(H)?(/\bIE\b/.test(a)&&"Mac OS"==q&&(q=null),a="identify"+a):(a="mask"+a,H=T?v(T.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(a)&&(q=null),P||(j=null)),V=["Presto"],L.push(a));else H+=" Mobile";(a=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(t)||0)[1])&&(a=[parseFloat(a.replace(/\.(\d)$/,".0$1")),a],"Safari"==H&&"+"==a[1].slice(-1)?(H="WebKit Nightly",M="alpha",j=a[1].slice(0,-1)):j!=a[1]&&j!=(a[2]=(/\bSafari\/([\d.]+\+?)/i.exec(t)||0)[1])||(j=null),a[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec(t)||0)[1],537.36==a[0]&&537.36==a[2]&&parseFloat(a[1])>=28&&"WebKit"==V&&(V=["Blink"]),P&&(p||a[1])?(V&&(V[1]="like Chrome"),a=a[1]||((a=a[0])<530?1:a<532?2:a<532.05?3:a<533?4:a<534.03?5:a<534.07?6:a<534.1?7:a<534.13?8:a<534.16?9:a<534.24?10:a<534.3?11:a<535.01?12:a<535.02?"13+":a<535.07?15:a<535.11?16:a<535.19?17:a<536.05?18:a<536.1?19:a<537.01?20:a<537.11?"21+":a<537.13?23:a<537.18?24:a<537.24?25:a<537.36?26:"Blink"!=V?"27":"28")):(V&&(V[1]="like Safari"),a=(a=a[0])<400?1:a<500?2:a<526?3:a<533?4:a<534?"4+":a<535?5:a<537?6:a<538?7:a<601?8:a<602?9:a<604?10:a<606?11:a<608?12:"12"),V&&(V[1]+=" "+(a+="number"==typeof a?".x":/[.+]/.test(a)?"":"+")),"Safari"==H&&(!j||parseInt(j)>45)?j=a:"Chrome"==H&&/\bHeadlessChrome/i.test(t)&&L.unshift("headless")),"Opera"==H&&(a=/\bzbov|zvav$/.exec(q))?(H+=" ",L.unshift("desktop mode"),"zvav"==a?(H+="Mini",j=null):H+="Mobile",q=q.replace(RegExp(" *"+a+"$"),"")):"Safari"==H&&/\bChrome\b/.exec(V&&V[1])?(L.unshift("desktop mode"),H="Chrome Mobile",j=null,/\bOS X\b/.test(q)?(F="Apple",q="iOS 4.3+"):q=null):/\bSRWare Iron\b/.test(H)&&!j&&(j=W("Chrome")),j&&0==j.indexOf(a=/[\d.]+$/.exec(q))&&t.indexOf("/"+a+"-")>-1&&(q=w(q.replace(a,""))),q&&-1!=q.indexOf(H)&&!RegExp(H+" OS").test(q)&&(q=q.replace(RegExp(" *"+y(H)+" *"),"")),V&&!/\b(?:Avant|Nook)\b/.test(H)&&(/Browser|Lunascape|Maxthon/.test(H)||"Safari"!=H&&/^iOS/.test(q)&&/\bSafari\b/.test(V[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|SRWare Iron|Vivaldi|Web)/.test(H)&&V[1])&&(a=V[V.length-1])&&L.push(a),L.length&&(L=["("+L.join("; ")+")"]),F&&U&&U.indexOf(F)<0&&L.push("on "+F),U&&L.push((/^on /.test(L[L.length-1])?"":"on ")+U),q&&(a=/ ([\d.+]+)$/.exec(q),l=a&&"/"==q.charAt(q.length-a[0].length-1),q={architecture:32,family:a&&!l?q.replace(a[0],""):q,version:a?a[1]:null,toString:function(){var e=this.version;return this.family+(e&&!l?" "+e:"")+(64==this.architecture?" 64-bit":"")}}),(a=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(D))&&!/\bi686\b/i.test(D)?(q&&(q.architecture=64,q.family=q.family.replace(RegExp(" *"+a),"")),H&&(/\bWOW64\b/i.test(t)||P&&/\w(?:86|32)$/.test(r.cpuClass||r.platform)&&!/\bWin64; x64\b/i.test(t))&&L.unshift("32-bit")):q&&/^OS X/.test(q.family)&&"Chrome"==H&&parseFloat(j)>=39&&(q.architecture=64),t||(t=null);var G={};return G.description=t,G.layout=V&&V[0],G.manufacturer=F,G.name=H,G.prerelease=M,G.product=U,G.ua=t,G.version=H&&j,G.os=q||{architecture:null,family:null,version:null,toString:function(){return"null"}},G.parse=e,G.toString=function(){return this.description||""},G.version&&L.unshift(j),G.name&&L.unshift(H),q&&H&&(q!=String(q).split(" ")[0]||q!=H.split(" ")[0]&&!U)&&L.push(U?"("+q+")":"on "+q),L.length&&(G.description=L.join(" ")),G}();o.platform=S,void 0===(i=function(){return S}.call(t,n,t,e))||(e.exports=i)}.call(this)},445:function(e){e.exports=function(e,t,n,i){var r=n?n.call(i,e,t):void 0;if(void 0!==r)return!!r;if(e===t)return!0;if("object"!=typeof e||!e||"object"!=typeof t||!t)return!1;var o=Object.keys(e),s=Object.keys(t);if(o.length!==s.length)return!1;for(var a=Object.prototype.hasOwnProperty.bind(t),l=0;l<o.length;l++){var u=o[l];if(!a(u))return!1;var c=e[u],h=t[u];if(!1===(r=n?n.call(i,c,h,u):void 0)||void 0===r&&c!==h)return!1}return!0}},876:function(e){"use strict";e.exports=JSON.parse('{"u2":"tracking-code","i8":"2.10.3"}')}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var o=t[i]={id:i,loaded:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},function(){const e="undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{};e.SENTRY_RELEASE={id:"tracking-code@2.10.3"},e.SENTRY_RELEASES=e.SENTRY_RELEASES||{},e.SENTRY_RELEASES["ls-track@livesession-trackjs"]={id:"tracking-code@2.10.3"}}(),function(){"use strict";function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function t(t,n){if(t){if("string"==typeof t)return e(t,n);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?e(t,n):void 0}}function r(n){return function(t){if(Array.isArray(t))return e(t)}(n)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(n)||t(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)e[i]=n[i]}return e}var s=function e(t,n){function i(e,i,r){if("undefined"!=typeof document){"number"==typeof(r=o({},n,r)).expires&&(r.expires=new Date(Date.now()+864e5*r.expires)),r.expires&&(r.expires=r.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var s="";for(var a in r)r[a]&&(s+="; "+a,!0!==r[a]&&(s+="="+r[a].split(";")[0]));return document.cookie=e+"="+t.write(i,e)+s}}return Object.create({set:i,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var n=document.cookie?document.cookie.split("; "):[],i={},r=0;r<n.length;r++){var o=n[r].split("="),s=o.slice(1).join("=");try{var a=decodeURIComponent(o[0]);if(i[a]=t.read(s,a),e===a)break}catch(e){}}return e?i[e]:i}},remove:function(e,t){i(e,"",o({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,o({},this.attributes,t))},withConverter:function(t){return e(o({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(n)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"}),a=s,l=n(278),u=n.n(l),c=n(876);function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}var d=n(445);function f(e,t){var n=[];if(["string","number"].indexOf(h(e))>-1)return n;for(var i in e){var r=t(e[i],i);n.push(r)}return n}function p(e){if(null==e)return!0;if(e.length>0)return!1;if(0===e.length)return!0;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function v(e){return function(e){return!!e&&("object"===("undefined"==typeof Node?"undefined":h(Node))?e instanceof Node:"object"===h(e)&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName)}(e)&&"object"===("undefined"==typeof HTMLElement?"undefined":h(HTMLElement))?e instanceof HTMLElement:"object"===h(e)&&null!==e&&1===e.nodeType&&"string"==typeof e.nodeName}var m=function(){return m=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},m.apply(this,arguments)},g="?",y=/^\s*at (?:(.*?) ?\()?((?:file|https?|blob|chrome-extension|address|native|eval|webpack|<anonymous>|[-a-z]+:|.*bundle|\/).*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,b=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:file|https?|blob|chrome|webpack|resource|moz-extension|capacitor).*?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,w=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:file|ms-appx|https?|webpack|blob):.*?):(\d+)(?::(\d+))?\)?\s*$/i,S=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,E=/\((\S*)(?::(\d+))(?::(\d+))\)/,k=/Minified React error #\d+;/i;function O(e){var t=null,n=0;e&&("number"==typeof e.framesToPop?n=e.framesToPop:k.test(e.message)&&(n=1));try{if(t=function(e){if(!e||!e.stacktrace)return null;for(var t,n=e.stacktrace,i=/ line (\d+).*script (?:in )?(\S+)(?:: in function (\S+))?$/i,r=/ line (\d+), column (\d+)\s*(?:in (?:<anonymous function: ([^>]+)>|([^)]+))\((.*)\))? in (.*):\s*$/i,o=n.split("\n"),s=[],a=0;a<o.length;a+=2){var l=null;(t=i.exec(o[a]))?l={url:t[2],func:t[3],args:[],line:+t[1],column:null}:(t=r.exec(o[a]))&&(l={url:t[6],func:t[3]||t[4],args:t[5]?t[5].split(","):[],line:+t[1],column:+t[2]}),l&&(!l.func&&l.line&&(l.func=g),s.push(l))}if(!s.length)return null;return{message:x(e),name:e.name,stack:s}}(e),t)return R(t,n)}catch(e){}try{if(t=function(e){var t,n;if(!e||!e.stack)return null;for(var i,r,o,s=[],a=e.stack.split("\n"),l=0;l<a.length;++l){if(r=y.exec(a[l])){var u=r[2]&&0===r[2].indexOf("native");r[2]&&0===r[2].indexOf("eval")&&(i=E.exec(r[2]))&&(r[2]=i[1],r[3]=i[2],r[4]=i[3]);var c=r[2]&&0===r[2].indexOf("address at ")?r[2].substr("address at ".length):r[2],h=r[1]||g;h=(t=I(h,c))[0],o={url:c=t[1],func:h,args:u?[r[2]]:[],line:r[3]?+r[3]:null,column:r[4]?+r[4]:null}}else if(r=w.exec(a[l]))o={url:r[2],func:r[1]||g,args:[],line:+r[3],column:r[4]?+r[4]:null};else{if(!(r=b.exec(a[l])))continue;r[3]&&r[3].indexOf(" > eval")>-1&&(i=S.exec(r[3]))?(r[1]=r[1]||"eval",r[3]=i[1],r[4]=i[2],r[5]=""):0!==l||r[5]||void 0===e.columnNumber||(s[0].column=e.columnNumber+1);c=r[3],h=r[1]||g;h=(n=I(h,c))[0],o={url:c=n[1],func:h,args:r[2]?r[2].split(","):[],line:r[4]?+r[4]:null,column:r[5]?+r[5]:null}}!o.func&&o.line&&(o.func=g),s.push(o)}if(!s.length)return null;return{message:x(e),name:e.name,stack:s}}(e),t)return R(t,n)}catch(e){}return{message:x(e),name:e&&e.name,stack:[],failed:!0}}var I=function(e,t){var n=-1!==e.indexOf("safari-extension"),i=-1!==e.indexOf("safari-web-extension");return n||i?[-1!==e.indexOf("@")?e.split("@")[0]:g,n?"safari-extension:".concat(t):"safari-web-extension:".concat(t)]:[e,t]};function R(e,t){try{return m(m({},e),{stack:e.stack.slice(t)})}catch(t){return e}}function x(e){var t=e&&e.message;return t?t.error&&"string"==typeof t.error.message?t.error.message:t:"No error message"}function C(e){var t=function(e){var t=N(e.stack),n={type:e.name,value:e.message};return t&&t.length&&(n.stacktrace={frames:t}),void 0===n.type&&""===n.value&&(n.value="Unrecoverable error caught"),n}(e);return{exception:{values:[t]}}}function N(e){if(!e||!e.length)return[];var t=e,n=t[0].func||"",i=t[t.length-1].func||"";return-1===n.indexOf("captureMessage")&&-1===n.indexOf("captureException")||(t=t.slice(1)),-1!==i.indexOf("sentryWrapped")&&(t=t.slice(0,-1)),t.slice(0,50).map((function(e){return{colno:null===e.column?void 0:e.column,filename:e.url||t[0].url,function:e.func||"?",in_app:!0,lineno:null===e.line?void 0:e.line}})).reverse()}var _=function(){return _=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},_.apply(this,arguments)},A=function(e,t,n){if(n||2===arguments.length)for(var i,r=0,o=t.length;r<o;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},T=n(876).i8,D=n(876).u2,L=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];V.apply(void 0,A(["BugTracker"],e,!1))},M=function(e,t){return e.filter((function(e){return d(e,t)})).length>0},P=new(function(){function e(e){var t=e.limit;this.limit=0,this.counter=0,this.sentErrors=[],this.enabled=!1,this.limit=t,this.counter=0,this.sentErrors=[]}return e.prototype.send=function(e){var t;if(this.enabled)if(this.counter>=this.limit||M(this.sentErrors,e))L("omit error:",e);else{this.counter++,this.sentErrors.push(e);var n=C(O(e)),i="".concat(D,"@").concat(T).concat(""),r=_(_({},n),{message:e.message,timestamp:(new Date).toISOString(),environment:"production",extra:{version:1666189088,account_id:window.__lsAID,website_id:window.__lsWID},request:{url:null===(t=null===window||void 0===window?void 0:window.location)||void 0===t?void 0:t.href,headers:{Referer:null===document||void 0===document?void 0:document.referrer,"User-Agent":null===navigator||void 0===navigator?void 0:navigator.userAgent}},release:i,level:"error",platform:"javascript"});try{var o=new XMLHttpRequest;o.open("POST","https://sentry.io/api/6350274/store/",!0),o.setRequestHeader("Content-Type","application/json"),o.setRequestHeader("X-Sentry-Auth","Sentry sentry_version=7, sentry_key=b8d30adf717a41c8adddfc9b9d4f428b, sentry_client=raven-bash/0.1"),o.send(JSON.stringify(r))}catch(e){L("Failed to send:",e)}}},e}())({limit:10}),j=function(e){try{for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];e.apply(void 0,n)}catch(e){return V("Tools","Error:",e),P.send(e),!1}return!0},V=function(e){if(window.__ls_debug){for(var t,n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];(t=console).log.apply(t,["[LS]["+e+"]"].concat(i))}},H=function(){for(var e,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];(e=console).warn.apply(e,["[LiveSession]"].concat(n))},U=function(e){for(var t=window.location.search.substring(1).split("&"),n=0;n<t.length;n++){var i=t[n].split("=");if(decodeURIComponent(i[0])==e)return decodeURIComponent(i[1])}},F=function(e,t,n){if(n||2===arguments.length)for(var i,r=0,o=t.length;r<o;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},q=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];V.apply(void 0,F(["EventListener"],e,!1))},B=function(){function e(e){var t=e.utils;this.utils=t,this.flush()}return e.prototype.flush=function(){q("flush"),this.onceEvents={},this.events={}},e.prototype.on=function(e,t,n){return q("on:",e),this.events[e]=this.events[e]||{},n||(n=this.utils.UUID()),this.events[e][n]=t,n},e.prototype.once=function(e,t,n){return q("once:",e),this.onceEvents[e]=this.onceEvents[e]||{},n||(n=this.utils.UUID()),this.onceEvents[e][n]=t,n},e.prototype.call=function(e){q("call:",e);var t=[].splice.call(arguments,1);this.events[e]&&u()(this.events[e],(function(e){j((function(){return e.apply(void 0,t)}))})),this.onceEvents[e]&&(u()(this.onceEvents[e],(function(e){j((function(){return e.apply(void 0,t)}))})),this.onceEvents[e]={})},e}();function W(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function G(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function X(e,t,n){return t&&G(e.prototype,t),n&&G(e,n),e}var z=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];V.apply(void 0,["Conditions"].concat(t))},Y=function(){function e(t){var n=t.globalEvents;W(this,e),this.globalEvents=n,this.enabled=!1,this.list=[],this.eventsConditions=[],this.Reset(),this.operators={start:function(e,t){return 0==e.indexOf(t)},contain:function(e,t){return e.indexOf(t)>-1},end:function(e,t){return e.indexOf(t)==e.length-t.length},eq:function(e,t){return e==t},neq:function(e,t){return e!==t},gt:function(e,t){return e>t},gte:function(e,t){return e>=t},lt:function(e,t){return e<t},lte:function(e,t){return e<=t}}}return X(e,[{key:"Set",value:function(e){var t=this;z("set:",e),u()(e,(function(e){switch(e.type){case"event":t.conds.events.push(e),t.eventsConditions=e.name;break;case"session":t.conds.session.push(e);break;case"pageView":t.conds.pageview.push(e);break;default:z("unknown condition type:",e.type)}})),this.checkFulfilled()}},{key:"Restart",value:function(e){this.Reset(),this.Set(e),this.Enable()}},{key:"Reset",value:function(){this.done=!1,this.conds={events:[],session:[],pageview:[]},this.eventsConditions=[]}},{key:"Enable",value:function(){this.enabled=!0}},{key:"Disable",value:function(){this.enabled=!1}},{key:"IsEnabled",value:function(){return this.enabled}},{key:"IsEmpty",value:function(){return 0===this.list.length}},{key:"IsSet",value:function(){return!this.IsEmpty()}},{key:"IsFulfilled",value:function(){return this.done||0===this.conds.events.length&&0===this.conds.session.length&&0===this.conds.pageview.length}},{key:"EventsConditions",value:function(){return this.eventsConditions}},{key:"checkFulfilled",value:function(){!this.done&&this.IsFulfilled()&&(this.done=!0,this.globalEvents.call("conditions.fulfilled"))}},{key:"CheckEventData",value:function(e){var t=this;if(this.IsEnabled()&&!this.IsFulfilled()){var n=[];u()(this.conds.events,(function(i,r){if(Array.isArray(i.name)){var o=!1;u()(i.name,(function(t){e.name==t&&(o=!0)})),o&&(z("fulfilled:",i),n.push(r))}else e.name==i.name&&(i.operator&&i.value&&i.key?t.operators[i.operator]?e[i.key]?(z("check condition:",i,e),t.operators[i.operator](e[i.key],i.value)&&(z("fulfilled:",i),n.push(r))):console.warn("[LiveSession] invalid condition key for:",i):console.warn("[LiveSession] invalid condition operator for:",i):(z("fulfilled:",i),n.push(r)))})),this.clearConds(this.conds.events,n),this.checkFulfilled()}}},{key:"CheckSessionData",value:function(e){this.IsEnabled()&&!this.IsFulfilled()&&(this.checkFulfilledData(this.conds.session,e),this.checkFulfilled())}},{key:"CheckPageViewData",value:function(e){this.IsEnabled()&&!this.IsFulfilled()&&(this.checkFulfilledData(this.conds.pageview,e),this.checkFulfilled())}},{key:"checkFulfilledData",value:function(e,t){var n=this,i=[];u()(e,(function(e,r){if(Array.isArray(e.name)){var o=!1;u()(e.name,(function(e){t.name==e&&(o=!0)})),o&&(z("fulfilled:",e),i.push(r))}else{var s=get(t,e.name);n.operators[e.operator]?n.operators[e.operator](s,e.value)&&(z("fulfilled:",e),i.push(r)):console.warn("[LiveSession] invalid condition operator for:",e)}})),this.clearConds(e,i)}},{key:"clearConds",value:function(e,t){for(var n=e.length-1;n>=0;n--){var i=t.indexOf(n);i>-1&&e.splice(t[i],1)}}}]),e}(),K=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];V.apply(void 0,["XHRTransport"].concat(t))},$=function(){function e(t){var n=t.options,i=t.globalEvents,r=t.visitor,o=t.pageView;W(this,e),this.visitor=r,this.options=n,this.globalEvents=i,this.pageView=o}return X(e,[{key:"Init",value:function(){}},{key:"getAPI",value:function(){return"https://rs.livesession.io/visitors"}},{key:"sendFetch",value:function(e,t,n,i,r){return fetch(t,{method:e,headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).then((function(e){return e.json().then((function(t){return new Promise((function(n,o){return 200===e.status?i(t):r(t)}))}))})).catch((function(e){return K("Error:",e),new Promise((function(t,n){n(e)}))}))}},{key:"sendXHR",value:function(e,t,n,i,r){var o=new XMLHttpRequest;o.onreadystatechange=function(){if(4===o.readyState)try{o&&200===o.status?i(o.responseText):r&&r({statusCode:o.status,response:o.responseText})}catch(e){K(e)}},o.open(e,t,!0),o.send(JSON.stringify(n))}},{key:"handleError",value:function(e){if(e)switch(e.type){case"turn_off":this.globalEvents.call("api.response.turn_off");break;case"session_expired":this.globalEvents.call("api.session.expired");break;case"malformed_data":this.globalEvents.call("api.session.malformed_data");break;default:K("Unsupported error: ".concat(e))}}},{key:"send",value:function(e,t,n,i,r,o){var s=this,a=arguments.length>6&&void 0!==arguments[6]&&arguments[6];i.account_id=this.options.AccountID(),-1!=this.options.WebsiteID()?i.website_id=this.options.WebsiteID():console.warn("[LiveSession] Your tracking script is outdated. Please update it.");var l=Object.keys(i).map((function(e){return e+"="+i[e]})).join("&"),u=this.getAPI()+t+"?"+l;return a&&navigator.sendBeacon?(navigator.sendBeacon(u,JSON.stringify(n)),void K("Send ".concat(t," (beacon):"),n)):(K("Send ".concat(t,":"),n),this.sendXHR(e,u,n,(function(e){var t=JSON.parse(e);if(t&&t.error){var n=t.error;return s.handleError(n),o(n)}return r(t)}),(function(e){var t=e.response;try{var n=JSON.parse(t);n&&n.error&&"session_expired"==n.error.type&&s.globalEvents.call("api.session.expired"),o(n.error)}catch(e){K(e)}})))}},{key:"SendBundle",value:function(e,t,n,i,r,o){return this.send("POST","/bundle",{page_view_id:this.pageView.ID(),page_creation_timestamp:this.pageView.CreationTimestamp(),visitor_side_storage:this.visitor.JSON(),events:e,error:o},i,t,n,r,o)}},{key:"PageViewInit",value:function(e,t){return this.send("GET","/init",null,{},e,t)}},{key:"SendPageView",value:function(e,t,n){return this.send("POST","/page_view",e,{},t,n)}},{key:"SendIntegrationProps",value:function(e,t,n){return this.send("POST","/props",e,{},t,n)}}]),e}();function J(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Q(e,t){return Q=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Q(e,t)}function Z(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Q(e,t)}function ee(e,t){if(t&&("object"===h(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return J(e)}function te(e){return te=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},te(e)}var ne,ie=(ne=function(e,t){return ne=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},ne(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}ne(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),re=function(e,t,n){if(n||2===arguments.length)for(var i,r=0,o=t.length;r<o;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},oe=function(){function e(){this.name="",this.supportShadow=!1}return e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];V.apply(void 0,re([this.name],e,!1))},e.prototype.setName=function(e){this.name=e},e.prototype.isDOMListener=function(){return!1},e.prototype.setSupportShadow=function(e){this.supportShadow=e},e}(),se=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ie(t,e),t.prototype.isDOMListener=function(){return!0},t}(oe),ae=function(){function e(t){var n=t.interval,i=t.fn;W(this,e),this.interval=n,this.id=-1,i&&this.Start(i)}return X(e,[{key:"IsOn",value:function(){return this.id>-1}},{key:"Start",value:function(e){this.IsOn()||(this.tick=function(){j(e)},this.id=window.setInterval(this.tick,this.interval))}},{key:"Stop",value:function(){this.IsOn()&&(window.clearInterval(this.id),this.id=-1,this.tick=function(){})}}]),e}();function le(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=te(e);if(t){var r=te(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ee(this,n)}}var ue=null,ce=null,he=function(e){Z(n,e);var t=le(n);function n(e){var i,r=e.utils,o=e.eventsStream,s=e.aquireInterval;return W(this,n),(i=t.call(this)).startTime=null,i.lastPosition={x:0,y:0},i.position={x:0,y:0},i.utils=r,i.eventsStream=o,i.ticker=new ae({interval:s}),i.eventFunc=function(e){return j(i.Handler.bind(J(i)),e)},i}return X(n,[{key:"Register",value:function(){return this.startTime=null,window.addEventListener("mousemove",this.eventFunc,!0),this.ticker.Start(this.Trigger.bind(this)),this.Get()}},{key:"Unregister",value:function(){this.startTime=null,window.removeEventListener("mousemove",this.eventFunc,!0),this.ticker.Stop()}},{key:"isValueChanged",value:function(){var e=this.lastPosition,t=e.x,n=e.y;return t!=this.position.x||n!=this.position.y}},{key:"Trigger",value:function(){this.isValueChanged()?(this.lastPosition={x:this.position.x,y:this.position.y,json_data:this.position.json_data},this.eventsStream.Add(this.name,this.position,this.startTime),this.startTime=null):this.startTime=null}},{key:"Handler",value:function(e){ue=Math.max(parseInt(e.clientX,10),0),ce=Math.max(parseInt(e.clientY,10),0),this.startTime||(this.startTime=this.utils.Time.Duration()),e.target,this.position={x:e.clientX,y:e.clientY,path:this.utils.DOM.FullPath(e.target),el:this.utils.DOM.ElementName(e.target),json_data:{v:this.utils.Time.Duration()-this.startTime,rx:e.pageX,ry:e.pageY}}}},{key:"Get",value:function(){return null!=ue&&null!=ce?{x:ue,y:ce}:null}}]),n}(se);function de(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=te(e);if(t){var r=te(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ee(this,n)}}var fe=function(e){Z(n,e);var t=de(n);function n(e){var i,r=e.utils,o=e.eventsStream;return W(this,n),(i=t.call(this)).utils=r,i.eventsStream=o,i.eventFunc=function(e){return j(i.Handler.bind(J(i)),e)},i}return X(n,[{key:"Register",value:function(){window.addEventListener("mouseup",this.eventFunc,!0)}},{key:"Unregister",value:function(){window.removeEventListener("mouseup",this.eventFunc,!0)}},{key:"Handler",value:function(e){this.eventsStream.Add(this.name,{x:e.pageX,y:e.pageY,path:this.utils.DOM.FullPath(e.target),el:this.utils.DOM.ElementName(e.target)})}}]),n}(se);function pe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=te(e);if(t){var r=te(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ee(this,n)}}var ve=function(e){Z(n,e);var t=pe(n);function n(e){var i,r=e.utils,o=e.eventsStream;return W(this,n),(i=t.call(this)).utils=r,i.eventsStream=o,i.eventFunc=i.Handler.bind(J(i)),i}return X(n,[{key:"Register",value:function(){window.addEventListener("mousedown",this.eventFunc,!0)}},{key:"Unregister",value:function(){window.removeEventListener("mousedown",this.eventFunc,!0)}},{key:"Handler",value:function(e){e.isTrusted&&this.eventsStream.Add(this.name,{x:e.pageX,y:e.pageY,path:this.utils.DOM.FullPath(e.target),el:this.utils.DOM.ElementName(e.target)})}}]),n}(se),me={MUTATION:"DOMChange",ELEMENT_BLUR:"ElementBlur",ELEMENT_FOCUS:"ElementFocus",LOCATION_CHANGE:"LocationChange",MOUSE_CLICK:"MouseClick",MOUSE_DOUBLE_CLICK:"MouseDoubleClick",MOUSE_DOWN:"MouseDown",MOUSE_MOVE:"MouseMove",TOUCH_MOVE:"TouchMove",MOUSE_UP:"MouseUp",SCROLL:"Scroll",SELECTION:"Selection",VALUE_CHANGE:"ValueChange",VALUE_SET:"ValueSet",FORM_SUBMIT:"FormSubmit",WINDOW_BLUR:"WindowBlur",WINDOW_FOCUS:"WindowFocus",WINDOW_RESIZE:"WindowResize",WINDOW_SCROLL:"WindowScroll",CSS_CHANGE:"CSSChange",RESOURCE_ADDED:"ResourceAdded",ERROR_CLICK:"ErrorClick",RAGE_CLICK:"RageClick",LOG:"Log",ERROR:"Error",CUSTOM:"Custom",PERFORMANCE:"Performance",TECHNOLOGY:"Technology",NET_LOG:"NetLog",NET_ERROR:"NetError",IDENTIFY:"Identify",ANIMATION:"Animation"},ge={DOMChange:1,ElementBlur:2,ElementFocus:3,LocationChange:4,MouseClick:5,MouseDoubleClick:6,MouseDown:7,MouseMove:8,TouchMove:9,MouseUp:10,Scroll:11,Selection:12,ValueChange:13,WindowBlur:14,WindowFocus:15,WindowResize:16,WindowScroll:17,CSSChange:18,ResourceAdded:19,ErrorClick:20,RageClick:21,FormSubmit:22,ValueSet:23,Log:24,Error:25,Custom:26,Performance:27,Technology:28,NetLog:29,NetError:30,Identify:31,Animation:32},ye={internal:0,log:1,info:2,warn:3,error:4,debug:5},be={log:"log",info:"info",warn:"warn",error:"error"},we="include",Se="exclude",Ee=function(e){return ge[e]},ke=[me.MOUSE_MOVE,me.TOUCH_MOVE,me.SCROLL,me.WINDOW_SCROLL];function Oe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=te(e);if(t){var r=te(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ee(this,n)}}var Ie=function(e){Z(n,e);var t=Oe(n);function n(e){var i,r=e.utils,o=e.eventsStream,s=e.mouseMoveHandler,a=e.touchMoveHandler,l=e.windowScrollHandler;return W(this,n),(i=t.call(this)).utils=r,i.eventsStream=o,i.windowScrollHandler=l,i.mouseMoveHandler=s,i.touchMoveHandler=a,i.eventFunc=function(e){return j(i.Handler.bind(J(i)),e)},i.eventAfterFunc=function(e){return j(i.AfterHandler.bind(J(i)),e)},i.errorFunc=function(e){return j(i.onError.bind(J(i)),e)},i}return X(n,[{key:"Register",value:function(){window.addEventListener("click",this.eventFunc,!0),window.addEventListener("click",this.eventAfterFunc,!1),window.addEventListener("error",this.errorFunc,!0)}},{key:"Unregister",value:function(){window.removeEventListener("click",this.eventFunc,!0),window.removeEventListener("click",this.eventAfterFunc,!1),window.removeEventListener("error",this.errorFunc,!0)}},{key:"onError",value:function(e){if(e){var t=e.error,n=void 0===t?{}:t;n&&(this.err={message:n.message,stack:n.stack||n.backtrace||n.stacktrace})}}},{key:"AfterHandler",value:function(e){(void 0===e.isTrusted||e.isTrusted)&&(0==e.screenX&&0==e.screenY||this.err&&this.eventsStream.Add(me.ERROR_CLICK,{x:e.pageX,y:e.pageY,path:this.utils.DOM.FullPathV2(e),txt:this.utils.DOM.Content(e.target),el:this.utils.DOM.ElementName(e.target),value:this.err.message,json_data:this.err}))}},{key:"handleRageClick",value:function(e){var t=this;-1!=this.rageClickTimeout&&(clearTimeout(this.rageClickTimeout),this.rageClickTimeout=-1),this.rageClickTimeout=setTimeout((function(){t.eventsStream.Add(me.RAGE_CLICK,{x:e.pageX,y:e.pageY,path:t.utils.DOM.FullPathV2(e),txt:t.utils.DOM.Content(e.target),el:t.utils.DOM.ElementName(e.target),json_data:{clicks:e.detail}})}),300)}},{key:"Handler",value:function(e){if((void 0===e.isTrusted||e.isTrusted)&&(0!=e.screenX||0!=e.screenY)){this.windowScrollHandler.Trigger(),"Desktop"==this.utils.getDeviceType()?this.mouseMoveHandler.Trigger():this.touchMoveHandler.Trigger(),e.detail>3&&this.handleRageClick(e);var t={x:e.pageX,y:e.pageY,path:this.utils.DOM.FullPathV2(e),txt:this.utils.DOM.Content(e.target),el:this.utils.DOM.ElementName(e.target)};this.err=null,this.eventsStream.Add(this.name,t)}}}]),n}(se);function Re(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=te(e);if(t){var r=te(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ee(this,n)}}var xe=function(e){Z(n,e);var t=Re(n);function n(e){var i,r=e.utils,o=e.eventsStream;return W(this,n),(i=t.call(this)).utils=r,i.eventsStream=o,i.eventFunc=i.Handler.bind(J(i)),i}return X(n,[{key:"Register",value:function(){window.addEventListener("dblclick",this.eventFunc,!0)}},{key:"Unregister",value:function(){window.removeEventListener("dblclick",this.eventFunc,!0)}},{key:"Handler",value:function(e){e.isTrusted&&this.eventsStream.Add(this.name,{x:e.pageX,y:e.pageY,path:this.utils.DOM.FullPath(e.target),el:this.utils.DOM.ElementName(e.target)})}}]),n}(se);function Ce(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=te(e);if(t){var r=te(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ee(this,n)}}var Ne=function(e){Z(n,e);var t=Ce(n);function n(e){var i,r=e.utils,o=e.eventsStream,s=e.aquireInterval;return W(this,n),(i=t.call(this)).lastValue={w:0,h:0},i.value={w:0,h:0},i.utils=r,i.eventsStream=o,i.ticker=new ae({interval:s}),i.eventHandler=function(e){return j(i.Handler.bind(J(i)),e)},i}return X(n,[{key:"Register",value:function(){window.addEventListener("resize",this.eventHandler,!0),this.ticker.Start(this.handleInterval.bind(this))}},{key:"Unregister",value:function(){window.removeEventListener("resize",this.eventHandler,!0),this.ticker.Stop()}},{key:"handleInterval",value:function(){var e=this.lastValue,t=e.w,n=e.h;t==this.value.w&&n==this.value.h||(this.lastValue={w:this.value.w,h:this.value.h},this.eventsStream.Add(this.name,{width:this.value.w,height:this.value.h}))}},{key:"Handler",value:function(e){var t=window.innerWidth||0,n=window.innerHeight||0,i=window.innerWidth<window.screen.width;/iPad|iPhone|iPod/.test(navigator.userAgent)&&i&&(t=window.screen.width),this.value={w:t,h:n}}}]),n}(se);function _e(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=te(e);if(t){var r=te(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ee(this,n)}}function Ae(){return(((null===(g=window)||void 0===g?void 0:g.pageYOffset)||(null===(y=document)||void 0===y||null===(b=y.body)||void 0===b?void 0:b.scrollTop)||(null===(w=document)||void 0===w||null===(S=w.documentElement)||void 0===S?void 0:S.scrollTop)||0)+((null===(d=window)||void 0===d?void 0:d.innerHeight)||(null===(f=document)||void 0===f||null===(p=f.documentElement)||void 0===p?void 0:p.clientHeight)||(null===(v=document)||void 0===v||null===(m=v.body)||void 0===m?void 0:m.clientHeight)||0))/Math.max((null===(e=document)||void 0===e||null===(t=e.body)||void 0===t?void 0:t.scrollHeight)||0,(null===(n=document)||void 0===n||null===(i=n.documentElement)||void 0===i?void 0:i.scrollHeight)||0,(null===(r=document)||void 0===r||null===(o=r.body)||void 0===o?void 0:o.offsetHeight)||0,(null===(s=document)||void 0===s||null===(a=s.documentElement)||void 0===a?void 0:a.offsetHeight)||0,(null===(l=document)||void 0===l||null===(u=l.body)||void 0===u?void 0:u.clientHeight)||0,(null===(c=document)||void 0===c||null===(h=c.documentElement)||void 0===h?void 0:h.clientHeight)||0)*100;var e,t,n,i,r,o,s,a,l,u,c,h,d,f,p,v,m,g,y,b,w,S}var Te,De,Le=function(e){Z(n,e);var t=_e(n);function n(e){var i,r=e.utils,o=e.eventsStream,s=e.aquireInterval;return W(this,n),(i=t.call(this)).startTime=null,i.lastPosition={x:0,y:0},i.topDepth={percent:0},i.position={x:0,y:0},i.intervalID=0,i.utils=r,i.eventsStream=o,i.ticker=new ae({interval:s}),i.eventFunc=i.Handler.bind(J(i)),i}return X(n,[{key:"Register",value:function(){return this.startTime=null,this.Handler(),this.Trigger(),window.addEventListener("scroll",this.eventFunc,!0),this.ticker.Start(this.Trigger.bind(this)),this.Get()}},{key:"Unregister",value:function(){this.startTime=null,window.removeEventListener("scroll",this.eventFunc,!0),this.ticker.Stop()}},{key:"Trigger",value:function(){var e=this.lastPosition,t=e.x,n=e.y;t!=this.position.x||n!=this.position.y?(this.lastPosition={x:this.position.x,y:this.position.y,json_data:this.position.json_data},this.eventsStream.Add(this.name,this.position,this.startTime),this.startTime=null,this.position.value=void 0):this.startTime=null}},{key:"Handler",value:function(e){var t,n,i,r,o,s,a,l,u,c,h,d;this.startTime||(this.startTime=this.utils.Time.Duration());var f=parseInt(pageXOffset||(null!==(t=document)&&void 0!==t&&null!==(n=t.documentElement)&&void 0!==n&&n.clientWidth?null===(i=document)||void 0===i||null===(r=i.documentElement)||void 0===r?void 0:r.scrollLeft:null===(o=document)||void 0===o||null===(s=o.body)||void 0===s?void 0:s.scrollLeft),10),p=parseInt(pageYOffset||(null!==(a=document)&&void 0!==a&&null!==(l=a.documentElement)&&void 0!==l&&l.clientHeight?null===(u=document)||void 0===u||null===(c=u.documentElement)||void 0===c?void 0:c.scrollTop:null===(h=document)||void 0===h||null===(d=h.body)||void 0===d?void 0:d.scrollTop),10);this.position={x:f,y:p,json_data:{v:this.utils.Time.Duration()-this.startTime},value:this.position.value||void 0};var v=this.calcGreatestScrollPercentage();v&&(this.position.value=v.toString())}},{key:"calcGreatestScrollPercentage",value:function(){var e=parseInt(Ae(),10);if(e>this.topDepth.percent||!this.topDepth.percent)return this.topDepth.percent=e,this.topDepth.percent}},{key:"Get",value:function(){this.Handler();var e=this.position,t=e.x,n=e.y,i=e.value,r=e.json_data;return{x:Math.max(t,0),y:Math.max(n,0),value:i,json_data:JSON.stringify(r)}}}]),n}(se),Me=(Te=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}Te(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});if(void 0===(De="undefined"!=typeof WebKitMutationObserver?WebKitMutationObserver:MutationObserver))throw console.error("DOM Mutation Observers are required."),console.error("https://developer.mozilla.org/en-US/docs/DOM/MutationObserver"),Error("DOM Mutation Observers are required");var Pe,je=function(){function e(){this.nodes=[],this.values=[]}return e.prototype.isIndex=function(e){return+e==e>>>0},e.prototype.nodeId=function(t){var n=t[e.ID_PROP];return n||(n=t[e.ID_PROP]=e.nextId_++),n},e.prototype.set=function(e,t){var n=this.nodeId(e);this.nodes[n]=e,this.values[n]=t},e.prototype.get=function(e){var t=this.nodeId(e);return this.values[t]},e.prototype.has=function(e){return this.nodeId(e)in this.nodes},e.prototype.delete=function(e){var t=this.nodeId(e);delete this.nodes[t],this.values[t]=void 0},e.prototype.keys=function(){var e=[];for(var t in this.nodes)this.isIndex(t)&&e.push(this.nodes[t]);return e},e.ID_PROP="__mutation_summary_node_map_id__",e.nextId_=1,e}();!function(e){e[e.STAYED_OUT=0]="STAYED_OUT",e[e.ENTERED=1]="ENTERED",e[e.STAYED_IN=2]="STAYED_IN",e[e.REPARENTED=3]="REPARENTED",e[e.REORDERED=4]="REORDERED",e[e.EXITED=5]="EXITED"}(Pe||(Pe={}));var Ve=function(){function e(e,t,n,i,r,o,s,a){void 0===t&&(t=!1),void 0===n&&(n=!1),void 0===i&&(i=!1),void 0===r&&(r=null),void 0===o&&(o=!1),void 0===s&&(s=null),void 0===a&&(a=null),this.node=e,this.childList=t,this.attributes=n,this.characterData=i,this.oldParentNode=r,this.added=o,this.attributeOldValues=s,this.characterDataOldValue=a,this.isCaseInsensitive=this.node.nodeType===Node.ELEMENT_NODE&&this.node instanceof HTMLElement&&this.node.ownerDocument instanceof HTMLDocument}return e.prototype.getAttributeOldValue=function(e){if(this.attributeOldValues)return this.isCaseInsensitive&&(e=e.toLowerCase()),this.attributeOldValues[e]},e.prototype.getAttributeNamesMutated=function(){var e=[];if(!this.attributeOldValues)return e;for(var t in this.attributeOldValues)e.push(t);return e},e.prototype.attributeMutated=function(e,t){this.attributes=!0,this.attributeOldValues=this.attributeOldValues||{},e in this.attributeOldValues||(this.attributeOldValues[e]=t)},e.prototype.characterDataMutated=function(e){this.characterData||(this.characterData=!0,this.characterDataOldValue=e)},e.prototype.removedFromParent=function(e){this.childList=!0,this.added||this.oldParentNode?this.added=!1:this.oldParentNode=e},e.prototype.insertedIntoParent=function(){this.childList=!0,this.added=!0},e.prototype.getOldParent=function(){if(this.childList){if(this.oldParentNode)return this.oldParentNode;if(this.added)return null}return this.node.parentNode},e}(),He=function(){this.added=new je,this.removed=new je,this.maybeMoved=new je,this.oldPrevious=new je,this.moved=void 0},Ue=function(e){function t(t,n){var i=e.call(this)||this;i.rootNode=t,i.reachableCache=void 0,i.wasReachableCache=void 0,i.anyParentsChanged=!1,i.anyAttributesChanged=!1,i.anyCharacterDataChanged=!1;for(var r=0;r<n.length;r++){var o=n[r];switch(o.type){case"childList":i.anyParentsChanged=!0;for(var s=0;s<o.removedNodes.length;s++){var a=o.removedNodes[s];i.getChange(a).removedFromParent(o.target)}for(s=0;s<o.addedNodes.length;s++){a=o.addedNodes[s];i.getChange(a).insertedIntoParent()}break;case"attributes":i.anyAttributesChanged=!0,i.getChange(o.target).attributeMutated(o.attributeName,o.oldValue);break;case"characterData":i.anyCharacterDataChanged=!0,i.getChange(o.target).characterDataMutated(o.oldValue)}}return i}return Me(t,e),t.prototype.getChange=function(e){var t=this.get(e);return t||(t=new Ve(e),this.set(e,t)),t},t.prototype.getOldParent=function(e){var t=this.get(e);return t?t.getOldParent():e.parentNode},t.prototype.getIsReachable=function(e){if(e===this.rootNode)return!0;if(!e)return!1;this.reachableCache=this.reachableCache||new je;var t=this.reachableCache.get(e);return void 0===t&&(t=this.getIsReachable(e.parentNode),this.reachableCache.set(e,t)),t},t.prototype.getWasReachable=function(e){if(e===this.rootNode)return!0;if(!e)return!1;this.wasReachableCache=this.wasReachableCache||new je;var t=this.wasReachableCache.get(e);return void 0===t&&(t=this.getWasReachable(this.getOldParent(e)),this.wasReachableCache.set(e,t)),t},t.prototype.reachabilityChange=function(e){return this.getIsReachable(e)?this.getWasReachable(e)?Pe.STAYED_IN:Pe.ENTERED:this.getWasReachable(e)?Pe.EXITED:Pe.STAYED_OUT},t}(je),Fe=function(){function e(e,t,n,i,r){this.rootNode=e,this.mutations=t,this.selectors=n,this.calcReordered=i,this.calcOldPreviousSibling=r,this.treeChanges=new Ue(e,t),this.entered=[],this.exited=[],this.stayedIn=new je,this.visited=new je,this.childListChangeMap=void 0,this.characterDataOnly=void 0,this.matchCache=void 0,this.processMutations()}return e.prototype.processMutations=function(){if(this.treeChanges.anyParentsChanged||this.treeChanges.anyAttributesChanged)for(var e=this.treeChanges.keys(),t=0;t<e.length;t++)this.visitNode(e[t],void 0)},e.prototype.visitNode=function(e,t){if(!this.visited.has(e)){this.visited.set(e,!0);var n=this.treeChanges.get(e),i=t;if((n&&n.childList||null==i)&&(i=this.treeChanges.reachabilityChange(e)),i!==Pe.STAYED_OUT){if(this.matchabilityChange(e),i===Pe.ENTERED)this.entered.push(e);else if(i===Pe.EXITED)this.exited.push(e),this.ensureHasOldPreviousSiblingIfNeeded(e);else if(i===Pe.STAYED_IN){var r=Pe.STAYED_IN;n&&n.childList&&(n.oldParentNode!==e.parentNode?(r=Pe.REPARENTED,this.ensureHasOldPreviousSiblingIfNeeded(e)):this.calcReordered&&this.wasReordered(e)&&(r=Pe.REORDERED)),this.stayedIn.set(e,r)}if(i!==Pe.STAYED_IN)for(var o=e.firstChild;o;o=o.nextSibling)this.visitNode(o,i)}}},e.prototype.ensureHasOldPreviousSiblingIfNeeded=function(e){if(this.calcOldPreviousSibling){this.processChildlistChanges();var t=e.parentNode,n=this.treeChanges.get(e);n&&n.oldParentNode&&(t=n.oldParentNode);var i=this.childListChangeMap.get(t);i||(i=new He,this.childListChangeMap.set(t,i)),i.oldPrevious.has(e)||i.oldPrevious.set(e,e.previousSibling)}},e.prototype.getChanged=function(e,t,n){this.selectors=t,this.characterDataOnly=n;for(var i=0;i<this.entered.length;i++){var r=this.entered[i];(a=this.matchabilityChange(r))!==Pe.ENTERED&&a!==Pe.STAYED_IN||e.added.push(r)}var o=this.stayedIn.keys();for(i=0;i<o.length;i++){r=o[i];if((a=this.matchabilityChange(r))===Pe.ENTERED)e.added.push(r);else if(a===Pe.EXITED)e.removed.push(r);else if(a===Pe.STAYED_IN&&(e.reparented||e.reordered)){var s=this.stayedIn.get(r);e.reparented&&s===Pe.REPARENTED?e.reparented.push(r):e.reordered&&s===Pe.REORDERED&&e.reordered.push(r)}}for(i=0;i<this.exited.length;i++){var a;r=this.exited[i];(a=this.matchabilityChange(r))!==Pe.EXITED&&a!==Pe.STAYED_IN||e.removed.push(r)}},e.prototype.getOldParentNode=function(e){var t=this.treeChanges.get(e);if(t&&t.childList)return t.oldParentNode?t.oldParentNode:null;var n=this.treeChanges.reachabilityChange(e);if(n===Pe.STAYED_OUT||n===Pe.ENTERED)throw Error("getOldParentNode requested on invalid node.");return e.parentNode},e.prototype.getOldPreviousSibling=function(e){var t=e.parentNode,n=this.treeChanges.get(e);n&&n.oldParentNode&&(t=n.oldParentNode);var i=this.childListChangeMap.get(t);if(!i)throw Error("getOldPreviousSibling requested on invalid node.");return i.oldPrevious.get(e)},e.prototype.getOldAttribute=function(e,t){var n=this.treeChanges.get(e);if(!n||!n.attributes)throw Error("getOldAttribute requested on invalid node.");var i=n.getAttributeOldValue(t);if(void 0===i)throw Error("getOldAttribute requested for unchanged attribute name.");return i},e.prototype.attributeChangedNodes=function(e){if(!this.treeChanges.anyAttributesChanged)return{};var t,n;if(e){t={},n={};for(var i=0;i<e.length;i++){t[h=e[i]]=!0,n[h.toLowerCase()]=h}}var r={},o=this.treeChanges.keys();for(i=0;i<o.length;i++){var s=o[i],a=this.treeChanges.get(s);if(a.attributes&&(Pe.STAYED_IN===this.treeChanges.reachabilityChange(s)&&Pe.STAYED_IN===this.matchabilityChange(s)))for(var l=s,u=a.getAttributeNamesMutated(),c=0;c<u.length;c++){var h=u[c];if(!t||t[h]||a.isCaseInsensitive&&n[h])a.getAttributeOldValue(h)!==l.getAttribute(h)&&(n&&a.isCaseInsensitive&&(h=n[h]),r[h]=r[h]||[],r[h].push(l))}}return r},e.prototype.getOldCharacterData=function(e){var t=this.treeChanges.get(e);if(!t||!t.characterData)throw Error("getOldCharacterData requested on invalid node.");return t.characterDataOldValue},e.prototype.getCharacterDataChanged=function(){if(!this.treeChanges.anyCharacterDataChanged)return[];for(var e=this.treeChanges.keys(),t=[],n=0;n<e.length;n++){var i=e[n];if(Pe.STAYED_IN===this.treeChanges.reachabilityChange(i)){var r=this.treeChanges.get(i);r.characterData&&i.textContent!=r.characterDataOldValue&&t.push(i)}}return t},e.prototype.computeMatchabilityChange=function(e,t){this.matchCache||(this.matchCache=[]),this.matchCache[e.uid]||(this.matchCache[e.uid]=new je);var n=this.matchCache[e.uid],i=n.get(t);return void 0===i&&(i=e.matchabilityChange(t,this.treeChanges.get(t)),n.set(t,i)),i},e.prototype.matchabilityChange=function(e){var t=this;if(this.characterDataOnly)switch(e.nodeType){case Node.COMMENT_NODE:case Node.TEXT_NODE:return Pe.STAYED_IN;default:return Pe.STAYED_OUT}if(!this.selectors)return Pe.STAYED_IN;if(e.nodeType!==Node.ELEMENT_NODE)return Pe.STAYED_OUT;for(var n=e,i=this.selectors.map((function(e){return t.computeMatchabilityChange(e,n)})),r=Pe.STAYED_OUT,o=0;r!==Pe.STAYED_IN&&o<i.length;){switch(i[o]){case Pe.STAYED_IN:r=Pe.STAYED_IN;break;case Pe.ENTERED:r=r===Pe.EXITED?Pe.STAYED_IN:Pe.ENTERED;break;case Pe.EXITED:r=r===Pe.ENTERED?Pe.STAYED_IN:Pe.EXITED}o++}return r},e.prototype.getChildlistChange=function(e){var t=this.childListChangeMap.get(e);return t||(t=new He,this.childListChangeMap.set(e,t)),t},e.prototype.processChildlistChanges=function(){if(!this.childListChangeMap){this.childListChangeMap=new je;for(var e=0;e<this.mutations.length;e++){var t=this.mutations[e];if("childList"==t.type&&(this.treeChanges.reachabilityChange(t.target)===Pe.STAYED_IN||this.calcOldPreviousSibling)){for(var n=this.getChildlistChange(t.target),i=t.previousSibling,r=0;r<t.removedNodes.length;r++){s(o=t.removedNodes[r],i),n.added.has(o)?n.added.delete(o):(n.removed.set(o,!0),n.maybeMoved.delete(o)),i=o}s(t.nextSibling,i);for(r=0;r<t.addedNodes.length;r++){var o=t.addedNodes[r];n.removed.has(o)?(n.removed.delete(o),n.maybeMoved.set(o,!0)):n.added.set(o,!0)}}function s(e,t){!e||n.oldPrevious.has(e)||n.added.has(e)||n.maybeMoved.has(e)||t&&(n.added.has(t)||n.maybeMoved.has(t))||n.oldPrevious.set(e,t)}}}},e.prototype.wasReordered=function(e){if(!this.treeChanges.anyParentsChanged)return!1;this.processChildlistChanges();var t=e.parentNode,n=this.treeChanges.get(e);n&&n.oldParentNode&&(t=n.oldParentNode);var i=this.childListChangeMap.get(t);if(!i)return!1;if(i.moved)return i.moved.get(e);i.moved=new je;var r=new je;function o(e){if(!e)return!1;if(!i.maybeMoved.has(e))return!1;var t=i.moved.get(e);return void 0!==t||(r.has(e)?t=!0:(r.set(e,!0),t=function(e){if(l.has(e))return l.get(e);var t=e.previousSibling;for(;t&&(i.added.has(t)||o(t));)t=t.previousSibling;return l.set(e,t),t}(e)!==a(e)),r.has(e)?(r.delete(e),i.moved.set(e,t)):t=i.moved.get(e)),t}var s=new je;function a(e){var t=s.get(e);if(void 0!==t)return t;for(t=i.oldPrevious.get(e);t&&(i.removed.has(t)||o(t));)t=a(t);return void 0===t&&(t=e.previousSibling),s.set(e,t),t}var l=new je;return i.maybeMoved.keys().forEach(o),i.moved.get(e)},e}(),qe=function(){function e(e,t){var n=this;if(this.projection=e,this.added=[],this.removed=[],this.reparented=t.all||t.element||t.characterData?[]:void 0,this.reordered=t.all?[]:void 0,e.getChanged(this,t.elementFilter,t.characterData),t.all||t.attribute||t.attributeList){var i=t.attribute?[t.attribute]:t.attributeList,r=e.attributeChangedNodes(i);t.attribute?this.valueChanged=r[t.attribute]||[]:(this.attributeChanged=r,t.attributeList&&t.attributeList.forEach((function(e){n.attributeChanged.hasOwnProperty(e)||(n.attributeChanged[e]=[])})))}if(t.all||t.characterData){var o=e.getCharacterDataChanged();t.characterData?this.valueChanged=o:this.characterDataChanged=o}this.reordered&&(this.getOldPreviousSibling=e.getOldPreviousSibling.bind(e))}return e.prototype.getOldParentNode=function(e){return this.projection.getOldParentNode(e)},e.prototype.getOldAttribute=function(e,t){return this.projection.getOldAttribute(e,t)},e.prototype.getOldCharacterData=function(e){return this.projection.getOldCharacterData(e)},e.prototype.getOldPreviousSibling=function(e){return this.projection.getOldPreviousSibling(e)},e}(),Be=/[a-zA-Z_]+/,We=/[a-zA-Z0-9_\-]+/;function Ge(e){return'"'+e.replace(/"/,'\\"')+'"'}var Xe=function(){function e(){}return e.prototype.matches=function(e){if(null===e)return!1;if(void 0===this.attrValue)return!0;if(!this.contains)return this.attrValue==e;for(var t=e.split(" "),n=0;n<t.length;n++)if(this.attrValue===t[n])return!0;return!1},e.prototype.toString=function(){return"class"===this.attrName&&this.contains?"."+this.attrValue:"id"!==this.attrName||this.contains?this.contains?"["+this.attrName+"~="+Ge(this.attrValue)+"]":"attrValue"in this?"["+this.attrName+"="+Ge(this.attrValue)+"]":"["+this.attrName+"]":"#"+this.attrValue},e}(),ze=function(){function e(){this.uid=e.nextUid++,this.qualifiers=[]}var t;return Object.defineProperty(e.prototype,"caseInsensitiveTagName",{get:function(){return this.tagName.toUpperCase()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectorString",{get:function(){return this.tagName+this.qualifiers.join("")},enumerable:!0,configurable:!0}),e.prototype.isMatching=function(t){return t[e.matchesSelector](this.selectorString)},e.prototype.wasMatching=function(e,t,n){if(!t||!t.attributes)return n;var i=t.isCaseInsensitive?this.caseInsensitiveTagName:this.tagName;if("*"!==i&&i!==e.tagName)return!1;for(var r=[],o=!1,s=0;s<this.qualifiers.length;s++){var a=this.qualifiers[s],l=t.getAttributeOldValue(a.attrName);r.push(l),o=o||void 0!==l}if(!o)return n;for(s=0;s<this.qualifiers.length;s++){a=this.qualifiers[s];if(void 0===(l=r[s])&&(l=e.getAttribute(a.attrName)),!a.matches(l))return!1}return!0},e.prototype.matchabilityChange=function(e,t){var n=this.isMatching(e);return n?this.wasMatching(e,t,n)?Pe.STAYED_IN:Pe.ENTERED:this.wasMatching(e,t,n)?Pe.EXITED:Pe.STAYED_OUT},e.parseSelectors=function(t){var n,i,r=[];function o(){n&&(i&&(n.qualifiers.push(i),i=void 0),r.push(n)),n=new e}function s(){i&&n.qualifiers.push(i),i=new Xe}for(var a,l=/\s/,u="Invalid or unsupported selector syntax.",c=1,h=0;h<t.length;){var d=t[h++];switch(c){case 1:if(d.match(Be)){o(),n.tagName=d,c=2;break}if("*"==d){o(),n.tagName="*",c=3;break}if("."==d){o(),s(),n.tagName="*",i.attrName="class",i.contains=!0,c=4;break}if("#"==d){o(),s(),n.tagName="*",i.attrName="id",c=4;break}if("["==d){o(),s(),n.tagName="*",i.attrName="",c=6;break}if(d.match(l))break;throw Error(u);case 2:if(d.match(We)){n.tagName+=d;break}if("."==d){s(),i.attrName="class",i.contains=!0,c=4;break}if("#"==d){s(),i.attrName="id",c=4;break}if("["==d){s(),i.attrName="",c=6;break}if(d.match(l)){c=14;break}if(","==d){c=1;break}throw Error(u);case 3:if("."==d){s(),i.attrName="class",i.contains=!0,c=4;break}if("#"==d){s(),i.attrName="id",c=4;break}if("["==d){s(),i.attrName="",c=6;break}if(d.match(l)){c=14;break}if(","==d){c=1;break}throw Error(u);case 4:if(d.match(Be)){i.attrValue=d,c=5;break}throw Error(u);case 5:if(d.match(We)){i.attrValue+=d;break}if("."==d){s(),i.attrName="class",i.contains=!0,c=4;break}if("#"==d){s(),i.attrName="id",c=4;break}if("["==d){s(),c=6;break}if(d.match(l)){c=14;break}if(","==d){c=1;break}throw Error(u);case 6:if(d.match(Be)){i.attrName=d,c=7;break}if(d.match(l))break;throw Error(u);case 7:if(d.match(We)){i.attrName+=d;break}if(d.match(l)){c=8;break}if("~"==d){i.contains=!0,c=9;break}if("="==d){i.attrValue="",c=11;break}if("]"==d){c=3;break}throw Error(u);case 8:if("~"==d){i.contains=!0,c=9;break}if("="==d){i.attrValue="",c=11;break}if("]"==d){c=3;break}if(d.match(l))break;throw Error(u);case 9:if("="==d){i.attrValue="",c=11;break}throw Error(u);case 10:if("]"==d){c=3;break}if(d.match(l))break;throw Error(u);case 11:if(d.match(l))break;if('"'==d||"'"==d){a=d,c=13;break}i.attrValue+=d,c=12;break;case 12:if(d.match(l)){c=10;break}if("]"==d){c=3;break}if("'"==d||'"'==d)throw Error(u);i.attrValue+=d;break;case 13:if(d==a){c=10;break}i.attrValue+=d;break;case 14:if(d.match(l))break;if(","==d){c=1;break}throw Error(u)}}switch(c){case 1:case 2:case 3:case 5:case 14:o();break;default:throw Error(u)}if(!r.length)throw Error(u);return r},e.nextUid=1,e.matchesSelector="function"==typeof(t=document.createElement("div")).webkitMatchesSelector?"webkitMatchesSelector":"function"==typeof t.mozMatchesSelector?"mozMatchesSelector":"function"==typeof t.msMatchesSelector?"msMatchesSelector":"matchesSelector",e}(),Ye=/^([a-zA-Z:_]+[a-zA-Z0-9_\-:\.]*)$/;function Ke(e){if("string"!=typeof e)throw Error("Invalid request opion. attribute must be a non-zero length string.");if(!(e=e.trim()))throw Error("Invalid request opion. attribute must be a non-zero length string.");if(!e.match(Ye))throw Error("Invalid request option. invalid attribute name: "+e);return e}function $e(e){if(!e.trim().length)throw Error("Invalid request option: elementAttributes must contain at least one attribute.");for(var t={},n={},i=e.split(/\s+/),r=0;r<i.length;r++){if(o=i[r]){var o,s=(o=Ke(o)).toLowerCase();if(t[s])throw Error("Invalid request option: observing multiple case variations of the same attribute is not supported.");n[o]=!0,t[s]=!0}}return Object.keys(n)}var Je=function(){function e(t){var n=this;this.connected=!1,this.options=e.validateOptions(t),this.observerOptions=e.createObserverOptions(this.options.queries),this.root=this.options.rootNode,this.callback=this.options.callback,this.elementFilter=Array.prototype.concat.apply([],this.options.queries.map((function(e){return e.elementFilter?e.elementFilter:[]}))),this.elementFilter.length||(this.elementFilter=void 0),this.calcReordered=this.options.queries.some((function(e){return e.all})),this.queryValidators=[],e.createQueryValidator&&(this.queryValidators=this.options.queries.map((function(t){return e.createQueryValidator(n.root,t)}))),this.observer=new De((function(e){n.observerCallback(e)})),this.reconnect()}return e.createObserverOptions=function(e){var t,n={childList:!0,subtree:!0};function i(e){n.attributes&&!t||(n.attributes=!0,n.attributeOldValue=!0,e?(t=t||{},e.forEach((function(e){t[e]=!0,t[e.toLowerCase()]=!0}))):t=void 0)}return e.forEach((function(e){if(e.characterData)return n.characterData=!0,void(n.characterDataOldValue=!0);if(e.all)return i(),n.characterData=!0,void(n.characterDataOldValue=!0);if(e.attribute)i([e.attribute.trim()]);else{var t=function(e){var t={};return e.forEach((function(e){e.qualifiers.forEach((function(e){t[e.attrName]=!0}))})),Object.keys(t)}(e.elementFilter).concat(e.attributeList||[]);t.length&&i(t)}})),t&&(n.attributeFilter=Object.keys(t)),n},e.validateOptions=function(t){for(var n in t)if(!(n in e.optionKeys))throw Error("Invalid option: "+n);if("function"!=typeof t.callback)throw Error("Invalid options: callback is required and must be a function");if(!t.queries||!t.queries.length)throw Error("Invalid options: queries must contain at least one query request object.");for(var i={callback:t.callback,rootNode:t.rootNode||document,observeOwnChanges:!!t.observeOwnChanges,oldPreviousSibling:!!t.oldPreviousSibling,queries:[]},r=0;r<t.queries.length;r++){var o=t.queries[r];if(o.all){if(Object.keys(o).length>1)throw Error("Invalid request option. all has no options.");i.queries.push({all:!0})}else if("attribute"in o){if((a={attribute:Ke(o.attribute)}).elementFilter=ze.parseSelectors("*["+a.attribute+"]"),Object.keys(o).length>1)throw Error("Invalid request option. attribute has no options.");i.queries.push(a)}else if("element"in o){var s=Object.keys(o).length,a={element:o.element,elementFilter:ze.parseSelectors(o.element)};if(o.hasOwnProperty("elementAttributes")&&(a.attributeList=$e(o.elementAttributes),s--),s>1)throw Error("Invalid request option. element only allows elementAttributes option.");i.queries.push(a)}else{if(!o.characterData)throw Error("Invalid request option. Unknown query request.");if(Object.keys(o).length>1)throw Error("Invalid request option. characterData has no options.");i.queries.push({characterData:!0})}}return i},e.prototype.createSummaries=function(e){if(!e||!e.length)return[];for(var t=new Fe(this.root,e,this.elementFilter,this.calcReordered,this.options.oldPreviousSibling),n=[],i=0;i<this.options.queries.length;i++)n.push(new qe(t,this.options.queries[i]));return n},e.prototype.checkpointQueryValidators=function(){this.queryValidators.forEach((function(e){e&&e.recordPreviousState()}))},e.prototype.runQueryValidators=function(e){this.queryValidators.forEach((function(t,n){t&&t.validate(e[n])}))},e.prototype.changesToReport=function(e){return e.some((function(e){if(["added","removed","reordered","reparented","valueChanged","characterDataChanged"].some((function(t){return e[t]&&e[t].length})))return!0;if(e.attributeChanged&&Object.keys(e.attributeChanged).some((function(t){return!!e.attributeChanged[t].length})))return!0;return!1}))},e.prototype.observerCallback=function(e){this.options.observeOwnChanges||this.observer.disconnect();var t=this.createSummaries(e);this.runQueryValidators(t),this.options.observeOwnChanges&&this.checkpointQueryValidators(),this.changesToReport(t)&&this.callback(t),!this.options.observeOwnChanges&&this.connected&&(this.checkpointQueryValidators(),this.observer.observe(this.root,this.observerOptions))},e.prototype.reconnect=function(){if(this.connected)throw Error("Already connected");this.observer.observe(this.root,this.observerOptions),this.connected=!0,this.checkpointQueryValidators()},e.prototype.takeSummaries=function(){if(!this.connected)throw Error("Not connected");var e=this.createSummaries(this.observer.takeRecords());return this.changesToReport(e)?e:void 0},e.prototype.disconnect=function(){var e=this.takeSummaries();return this.observer.disconnect(),this.connected=!1,e},e.NodeMap=je,e.parseElementFilter=ze.parseSelectors,e.optionKeys={callback:!0,queries:!0,rootNode:!0,oldPreviousSibling:!0,observeOwnChanges:!0},e}();function Qe(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Ze(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ze(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function Ze(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var et=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];V.apply(void 0,["tree-mirror-client"].concat(t))},tt=function(){function e(t,n,i,r){W(this,e);var o=this,s=[{all:!0}];this.mirror=n,this.utils=r,this.nextId=1,this.knownNodes=new Je.NodeMap,this.shadowRoots={};var a=this.serializeNode(t).id;this.mirror.initialize(a,this.getSerializedDocument(t)),i&&(s=s.concat(i)),this.mutationSummary=new Je({rootNode:t,callback:function(e){o.applyChanged(e)},queries:s})}return X(e,[{key:"attachShadowRoot",value:function(e){if(e){if(void 0===this.getNodeHostID(e)){var t=e.host,n=this.knownNodes.get(t);if(void 0!==n){this.setNodeHostID(e,n);var i=this.serializeNode(e,!1);this.mirror.applyChanged([],[i],[],[])}}}else et("Error:","shadow root not exists")}},{key:"compress",value:function(e){return e}},{key:"getSerializedDocument",value:function(e){for(var t=[],n=e.firstChild;n;n=n.nextSibling){var i=this.getNodeHostID(e);void 0!==i&&this.setNodeHostID(n,i),t.push(this.serializeNode(n,!0))}return t}},{key:"disconnect",value:function(){for(var e in this.mutationSummary&&(this.mutationSummary.disconnect(),this.mutationSummary=void 0),this.shadowRoots){var t=this.shadowRoots[e];this.mirror.removeShadowListeners(t)}}},{key:"rememberNode",value:function(e){var t=this.nextId++;return this.knownNodes.set(e,t),e._lsid=t,t}},{key:"getNodeHostID",value:function(e){var t=e._lshostid;if("number"==typeof t)return t}},{key:"setNodeHostID",value:function(e,t){e._lshostid=t}},{key:"forgetNode",value:function(e){this.knownNodes.delete(e)}},{key:"serializeNode",value:function(e,t){if(null===e)return null;var n=this.knownNodes.get(e),i=this.getNodeHostID(e);if(void 0!==n){var o={i:n};return void 0!==i&&(o.sHi=i),o}var s={nT:e.nodeType,i:this.rememberNode(e)};void 0!==i&&(s.sHi=i);var a=e;switch(s.nT){case Node.DOCUMENT_TYPE_NODE:var l=e;s.n=l.name,s.p=l.publicId,s.s=l.systemId,e&&e.adoptedStyleSheets&&this.mirror.onAdoptedStyleSheets(e);break;case Node.DOCUMENT_FRAGMENT_NODE:if(!this.isTargetShadowRoot(a))break;if(e&&e.adoptedStyleSheets&&this.mirror.onAdoptedStyleSheets(e),s.sR=!0,s.cN=[],this.registerShadowRoot(a,s.i),a.host){a.host._lsshadowroots||(a.host._lsshadowroots=new Set);for(var u={},c=a.host;c;){var h=this.getNodeHostID(c);if(u[h])break;if(void 0===h){a.host._lsshadowroots.add(a._lsid);break}if(!(c=this.knownNodes.nodes[h]))break;u[h]=!0,c._lsshadowroots||(c._lsshadowroots=new Set),c._lsshadowroots.add(a._lsid)}}t&&a.childNodes.length&&(s.cN=this.getSerializedDocument(a));break;case Node.COMMENT_NODE:case Node.TEXT_NODE:if(e.parentNode&&"TEXTAREA"===e.parentNode.tagName){s.tC=this.mirror.inputWatcher.getElementValue(e.parentNode,e.textContent);break}this.utils.DOM.isElementContentDisabled(e.parentNode)?s.tC=this.utils.StarifyString(e.textContent.trim()):s.tC=e.textContent;break;case Node.ELEMENT_NODE:s.tN=a.tagName,s.a={};var d=a.shadowRoot&&a.shadowRoot.host===a;d&&(s.sH=!0);for(var f=0;f<a.attributes.length;f++){var p=a.attributes[f];s.a[p.name.toLowerCase()]=p.value}switch(e.tagName){case"IMG":var v=this;this.utils.DOM.shouldMaskIMG(e)&&this.utils.DOM.maskIMG(s,e,(function(e){v.mirror.applyAttributesNodeData(e)}));break;case"INPUT":case"SELECT":case"TEXTAREA":s.a.value=this.mirror.inputWatcher.getElementValue(e,e.value)}if("SCRIPT"==a.tagName||"NOSCRIPT"==a.tagName)break;var m,g=t&&a.childNodes.length;if((d||g)&&(s.cN=[]),d){this.setNodeHostID(a.shadowRoot,s.i);var y=this.serializeNode(a.shadowRoot,!0);s.cN.push(y)}if(g)(m=s.cN).push.apply(m,r(this.getSerializedDocument(a)))}return this.mirror.visitNode&&this.mirror.visitNode(e,s),this.compressNode(s)}},{key:"serializeAddedAndMoved",value:function(e,t,n){var i=this,r=e.concat(t).concat(n),o=new Je.NodeMap;r.forEach((function(e){var t=e.parentNode,n=o.get(t);n||(n=new Je.NodeMap,o.set(t,n)),n.set(e,!0)}));var s=[];return o.keys().forEach((function(e){for(var t=o.get(e),n=t.keys();n.length;){for(var r=n[0];r.previousSibling&&t.has(r.previousSibling);)r=r.previousSibling;for(;r&&t.has(r);){var a=i.serializeNode(r);a.previousSibling=i.serializeNode(r.previousSibling),a.parentNode=i.serializeNode(r.parentNode),s.push(a),t.delete(r),r=r.nextSibling}n=t.keys()}})),s}},{key:"serializeAttributeChanges",value:function(e){var t=this,n=new Je.NodeMap;Object.keys(e).forEach((function(i){e[i].forEach((function(e){var r=n.get(e);r||((r=t.serializeNode(e)).a={},n.set(e,r)),r.a[i]=t.compress(e.getAttribute(i))}))}));var i=[];return n.keys().map((function(e){var t=n.get(e);switch(e.tagName){case"INPUT":case"SELECT":case"TEXTAREA":if(e.value){delete t.a.value;break}}p(t.a)||i.push(t)})),i}},{key:"compressNode",value:function(e){if((e.tC||e.a)&&(e.c=1),e.tC&&(e.tC=this.compress(e.tC)),e.a){var t=this;Object.keys(e.a).forEach((function(n){e.a[n]=t.compress(e.a[n])}))}return e}},{key:"applyChanged",value:function(e){var t=this,n=this,i=e[0],r=i.removed.map((function(e){return n.serializeNode(e)})),o=this.serializeAddedAndMoved(i.added,i.reparented,i.reordered),s=this.serializeAttributeChanges(i.attributeChanged),a=i.characterDataChanged.map((function(e){var t=n.serializeNode(e);return e.parentNode&&"TEXTAREA"===e.parentNode.tagName&&(t.tC=n.mirror.inputWatcher.getElementValue(e.parentNode,e.textContent)),n.utils.DOM.isElementContentDisabled(e.parentNode)?t.tC=n.utils.StarifyString(e.textContent.trim()):t.tC=e.textContent,t}));p(r)&&p(o)&&p(s)&&p(a)||this.mirror.applyChanged(r,o,s,a),i.removed.forEach((function(e){if(e&&e.shadowRoot){var i=n.knownNodes.get(e.shadowRoot);if(void 0!==i){if(!t.shadowRoots[i])return;n.unregisterShadowRoot(i)}}if(e._lsshadowroots){var r,o=Qe(e._lsshadowroots);try{for(o.s();!(r=o.n()).done;){var s=r.value,a=n.knownNodes.values[s];if(void 0!==a){if(!t.shadowRoots[a])continue;n.unregisterShadowRoot(a)}}}catch(e){o.e(e)}finally{o.f()}}n.forgetNode(e)}))}},{key:"registerShadowRoot",value:function(e,t){var n=this;e._lsmsummary=new Je({rootNode:e,callback:function(e){n.applyChanged(e)},queries:[{all:!0}]}),this.mirror.addShadowListeners(e),this.shadowRoots[t]=e,et("registered shadow root",t)}},{key:"unregisterShadowRoot",value:function(e){var t=this.shadowRoots[e];t?(delete this.shadowRoots[e],this.mirror.removeShadowListeners(t),et("unregistered shadow root",e)):et("Errror:","shadow root does not exists",e)}},{key:"isTargetShadowRoot",value:function(e){return"#document-fragment"===e.nodeName&&"ShadowRoot"===e.constructor.name}}]),e}(),nt=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),it=function(){return it=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},it.apply(this,arguments)},rt=function(e,t,n){if(n||2===arguments.length)for(var i,r=0,o=t.length;r<o;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},ot=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];V.apply(void 0,rt(["dom-mutation"],e,!1))},st=function(e){function t(t){var n=t.utils,i=t.eventsStream,r=t.globalEvents,o=t.inputWatcher,s=t.formWatcher,a=t.hooks,l=t.aquireInterval,u=t.pageView,c=t.handlers,h=e.call(this)||this;return h.utils=n,h.eventsStream=i,h.globalEvents=r,h.inputWatcher=o,h.formWatcher=s,h.hooks=a,h.handlers=c,h.cachedAttrs={},h.resourcesAdded={},h.ticker=new ae({interval:l,fn:h.onTick.bind(h)}),h.pageView=u,h.watchedEvents={},h}return nt(t,e),t.prototype.Register=function(){},t.prototype.Unregister=function(){this.mirror&&this.mirror.disconnect(),this.watchedEvents.attachShadow&&this.hooks.Unbind(this.watchedEvents.attachShadow)},t.prototype.onTick=function(){p(this.cachedAttrs)||this.addEvent([],[],this.getAndFlushCachedAttrs(),[])},t.prototype.watchResoucesNodes=function(e){for(var t=this,n=function(e,n,i){t.resourcesAdded[n]||(t.eventsStream.Add(me.RESOURCE_ADDED,{json_data:{type:e,href:n,base:t.pageView.GetBaseURL(),url:i}}),t.resourcesAdded[n]=!0)},i=0,r=e.length;i<r;i++){var o=e[i];switch(o.tN){case"LINK":if(o.a.rel)switch(o.a.rel){case"font":case"stylesheet":var s="";try{s=new URL(o.a.href,window.location.href).href}catch(e){continue}n(o.a.rel,o.a.href,s)}break;case"IMG":if(o.a["data-ls-disabled"])continue;var a="";try{a=new URL(o.a.src,window.location.href).href}catch(e){continue}n("image",o.a.src,a)}}},t.prototype.Handler=function(e,t,n,i){var r=this;n.length>0&&u()(n,(function(e){if(r.cachedAttrs[e.i]||(r.cachedAttrs[e.i]={}),r.cachedAttrs[e.i]=it(it({},r.cachedAttrs[e.i]),e.a),e.a&&e.a["data-ls-mask"]){var t=r.mirror.knownNodes.nodes[e.i];if(!t)return;var n=r;function i(e,i){var r={src:null,"data-ls-img":{w:e,h:i}};n.addEvent([],[],[{i:t._lsid,a:r}],[])}if(t.complete)return void i(t.width,t.height);t.onload=function(){i(this.width,this.height)}}})),(e.length>0||t.length>0||i.length>0)&&this.addEvent(e,t,this.getAndFlushCachedAttrs(),i)},t.prototype.getAndFlushCachedAttrs=function(){var e=[];return u()(this.cachedAttrs,(function(t,n){e.push({i:n,a:t})})),this.cachedAttrs={},e},t.prototype.disableImage=function(e){if(e.complete)return{w:e.width,h:e.height};var t=this;return e.onload=function(){t.addEvent([],[],[{i:this._lsid,a:{"data-ls-img":{w:this.width,h:this.height}}}],[])},null},t.prototype.applyAttributesNodeData=function(e){this.addEvent([],[],[e],[])},t.prototype.addEvent=function(e,t,n,i){var r={rmvd:e,admd:t,attr:n,txt:i};this.watchResoucesNodes(t),this.eventsStream.Add(this.name,{json_data:r})},t.prototype.addShadowListeners=function(e){this.handlers.AddShadowListeners(e)},t.prototype.removeShadowListeners=function(e){this.handlers.RemoveShadowListeners(e)},t.prototype.Init=function(){this.mirror=new tt(document,{inputWatcher:this.inputWatcher,initialize:this.onInitialized.bind(this),applyChanged:this.Handler.bind(this),visitNode:this.visitNode.bind(this),disableImage:this.disableImage.bind(this),applyAttributesNodeData:this.applyAttributesNodeData.bind(this),addShadowListeners:this.addShadowListeners.bind(this),removeShadowListeners:this.removeShadowListeners.bind(this),onAdoptedStyleSheets:this.onAdoptedStyleSheets.bind(this)},null,this.utils);var e=this;this.watchedEvents.attachShadow=this.hooks.Create(Element.prototype,"attachShadow",{after:function(){var t=this;j((function(){e.mirror&&t.shadowRoot?e.mirror.attachShadowRoot(t.shadowRoot):ot("Error","mirror and shadowRoot should exists")}))}}),this.globalEvents.call("handlers.".concat(this.name,".inited"),this.rootID,this.children,this.mirror)},t.prototype.GetPageBody=function(){var e=this.mirror.getSerializedDocument(document);return JSON.stringify(e)},t.prototype.onInitialized=function(e,t){this.rootID=e,this.children=t},t.prototype.visitNode=function(e,t){switch(e.tagName){case"FORM":this.formWatcher.registerForm(e,t.i);break;case"INPUT":case"TEXTAREA":case"SELECT":this.inputWatcher.registerInput(e,t.i)}},t.prototype.onAdoptedStyleSheets=function(e){var t=this;if(e){var n=e.adoptedStyleSheets;if(n){var i=this,r=i.utils.DOM.GetNodeID(e);r?this.addAdoptedStyleSheets(r,n):setTimeout((function(){var r=i.utils.DOM.GetNodeID(e);r&&t.addAdoptedStyleSheets(r,n)}),0)}else ot("adoptedStyleSheets not found")}},t.prototype.addAdoptedStyleSheets=function(e,t){var n=this.handlers.Get(me.CSS_CHANGE);n?n.addAdoptedStyleSheets(e,t):ot("cssChange handler not found")},t}(oe),at=function(){function e(t){var n=t.limit,i=t.interval,r=t.onLimit;W(this,e),this.remaining=n,this.limit=n,this.onLimit=r,this.ticker=new ae({interval:i,fn:this.onTick.bind(this)}),this.counter=0}return X(e,[{key:"onTick",value:function(){this.remaining=this.limit,this.counter=0}},{key:"Use",value:function(e){!function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];V.apply(void 0,["Throttle"].concat(t))}("Use:",this.counter++),0==this.remaining?this.onLimit():0<this.remaining&&e(),this.remaining--}},{key:"Stop",value:function(){return this.ticker.Stop(),this}},{key:"Start",value:function(){this.ticker.Start(this.onTick.bind(this))}}]),e}();function lt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=te(e);if(t){var r=te(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ee(this,n)}}var ut=function(e){Z(n,e);var t=lt(n);function n(e){var i,r=e.utils,o=e.eventsStream,s=e.aquireInterval,a=e.hooks;return W(this,n),(i=t.call(this)).utils=r,i.hooks=a,i.eventsStream=o,i.lastLocation="",i.throttle=new at({id:i.name+".throttle",interval:s,limit:2,onLimit:function(){V("LocationChange","throttled")}}),i.watchedEvents={},i.bindedHandler=i.Handler.bind(J(i)),i}return X(n,[{key:"Register",value:function(){this.throttle.Start(),window.addEventListener("popstate",this.bindedHandler),window.history&&(this.watchedEvents={pushState:this.hooks.Create(window.history,"pushState",{after:this.bindedHandler}),replaceState:this.hooks.Create(window.history,"replaceState",{after:this.bindedHandler})})}},{key:"Unregister",value:function(){this.throttle.Stop(),window.removeEventListener("popstate",this.bindedHandler),this.watchedEvents.pushState&&this.hooks.Unbind(this.watchedEvents.pushState),this.watchedEvents.replaceState&&this.hooks.Unbind(this.watchedEvents.replaceState)}},{key:"addEvent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=window.location.href;(e||this.lastLocation!=t)&&(this.lastLocation=t,this.eventsStream.Add(this.name,{location:t}))}},{key:"Handler",value:function(e){var t=this,n=!1;e&&null!==e.force&&(n=e.force),n?this.addEvent(n):this.throttle.Use((function(){return t.addEvent(n)}))}}]),n}(se),ct=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),ht=function(e){function t(t){var n=t.utils,i=t.eventsStream,r=t.globalEvents,o=t.aquireInterval,s=e.call(this)||this;return s.selectEventLength=5,s.utils=n,s.eventsStream=i,s.lastValue=[],s.lastValueSelected=!1,s.value=[],s.setSupportShadow(!0),s.eventHandler=function(e){return j(s.Handler.bind(s),e)},r.on("handlers.".concat(me.MUTATION,".inited"),(function(e,t,n){s.mirror=n})),s.ticker=new ae({interval:o}),s}return ct(t,e),t.prototype.Register=function(){this.AddListener(),this.ticker.Start(this.handleInterval.bind(this))},t.prototype.Unregister=function(){this.RemoveListener(),this.ticker.Stop()},t.prototype.AddListener=function(e){void 0===e&&(e=document),e.addEventListener("selectionstart",this.eventHandler),e.addEventListener("selectionchange",this.eventHandler)},t.prototype.RemoveListener=function(e){void 0===e&&(e=document),e.removeEventListener("selectionstart",this.eventHandler),e.removeEventListener("selectionchange",this.eventHandler)},t.prototype.Handler=function(e){if(!this.mirror)return null;this.value=this.selectionArgs()},t.prototype.handleInterval=function(){this.utils.ArrayEqual(this.lastValue,this.value)||(this.lastValue=this.value.slice(),(this.value.length===this.selectEventLength||this.lastValueSelected)&&this.eventsStream.Add(this.name,{json_data:this.value}),this.lastValueSelected=this.value.length===this.selectEventLength)},t.prototype.id=function(e){return this.mirror.knownNodes.get(e)},t.prototype.l=function(e,t){if(!e.firstChild)return[e,t];e=e.firstChild;for(var n=0;n<t-1&&e.nextSibling;n++)e=e.nextSibling;return[e,0]},t.prototype.selectionArgs=function(){if(!window.getSelection)return[];if(!(e=window.getSelection())||"None"==e.type)return[];if("Caret"==e.type)return(t=this.id(e.anchorNode))?[t,e.anchorOffset]:[];if(!e.anchorNode||!e.focusNode)return[];var e,t=(n=this.l(e.anchorNode,e.anchorOffset))[0],n=n[1],i=(e=this.l(e.focusNode,e.focusOffset))[0],r=e[1];t=(i=(e=Boolean(t.compareDocumentPosition(i)&Node.DOCUMENT_POSITION_FOLLOWING))?[t,i]:[i,t])[0],i=i[1],n=(r=e?[n,r]:[r,n])[0],r=r[1];for(this.id(t)||(n=0);t&&!this.id(t)&&t!=i;)t=t.nextSibling||t.parentNode;for(this.id(i)||(r=0);i&&!this.id(i)&&i!=t;)i=i.previousSibling||i.parentNode;if(t==i&&n==r)return[];var o=this.id(t),s=this.id(i);return t&&i&&o&&s?[o,n,s,r,e]:[]},t}(se);function dt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=te(e);if(t){var r=te(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ee(this,n)}}var ft=function(e){Z(n,e);var t=dt(n);function n(e){var i,r=e.utils,o=e.eventsStream,s=e.aquireInterval,a=e.globalEvents;return W(this,n),(i=t.call(this)).startTime=null,i.lastValue={el:null,x:0,y:0,lsid:null},i.value={el:null,x:0,y:0,json_data:{}},i.intervalID=0,i.setSupportShadow(!0),i.eventHandler=function(e){return j(i.Handler.bind(J(i)),e)},i.utils=r,i.eventsStream=o,i.ticker=new ae({interval:s}),a.on("handlers.".concat(me.MUTATION,".inited"),(function(e,t,n){i.mirror=n})),i}return X(n,[{key:"Register",value:function(){this.startTime=null,this.Handler(),this.handleInterval(),this.AddListener(),this.ticker.Start(this.handleInterval.bind(this))}},{key:"Unregister",value:function(){this.startTime=null,this.RemoveListener(),this.ticker.Stop()}},{key:"AddListener",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;e.addEventListener("scroll",this.eventHandler,!0)}},{key:"RemoveListener",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;e.removeEventListener("scroll",this.eventHandler,!0)}},{key:"isValueChanged",value:function(){var e=this.lastValue,t=e.x,n=e.y,i=e.el,r=e.lsid;return t!=this.value.x||n!=this.value.y||i!=this.value.el||this.value.json_data.lsid!=r}},{key:"handleInterval",value:function(){this.mirror&&this.isValueChanged()?(this.lastValue={el:this.value.el,x:this.value.x,y:this.value.y,lsid:this.value.json_data.lsid},this.eventsStream.Add(this.name,this.value,this.startTime),this.startTime=null):this.startTime=null}},{key:"Handler",value:function(e){e&&e.target&&null!==e.target.scrollLeft&&null!==e.target.scrollTop&&!isNaN(e.target.scrollLeft)&&!isNaN(e.target.scrollTop)&&this.mirror&&(this.startTime||(this.startTime=this.utils.Time.Duration()),this.value={x:e.target.scrollLeft,y:e.target.scrollTop,path:this.utils.DOM.FullPath(e.target),el:this.utils.DOM.ElementName(e.target),json_data:{lsid:this.mirror.knownNodes.get(e.target)}})}}]),n}(se),pt=n(23),vt=n.n(pt),mt=function(){function e(){W(this,e),this.recordingElementsMap=null}return X(e,[{key:"SetRecordingElementsMap",value:function(e){this.recordingElementsMap=e}},{key:"ToJSON",value:function(e){var t={nodeType:(e=e||this).nodeType};e.tagName?t.tagName=e.tagName.toLowerCase():e.nodeName&&(t.nodeName=e.nodeName),e.nodeValue&&(t.nodeValue=e.nodeValue);var n=e.attributes;if(n)for(var r=n.length,o=t.attributes=new Array(r),s=0;s<r;s++){var a=n[s];o[s]=[a.nodeName,a.nodeValue]}var l=e.childNodes;if(l)for(length=l.length,arr=t.childNodes=new Array(length),i=0;i<length;i++)arr[i]=toJSON(l[i]);return t}},{key:"ToDOM",value:function(e){"string"==typeof e&&(e=JSON.parse(e));var t,n=e.nodeType;switch(n){case 1:t=document.createElement(e.tagName);for(var r=e.attributes||[],o=0,s=r.length;o<s;o++){var a=r[o];t.setAttribute(a[0],a[1])}break;case 3:t=document.createTextNode(e.nodeValue);break;case 8:t=document.createComment(e.nodeValue);break;case 9:t=document.implementation.createDocument();break;case 10:t=document.implementation.createDocumentType(e.nodeName);break;case 11:t=document.createDocumentFragment();break;default:return t}if(1==n||11==n){var l=e.childNodes||[];for(i=0,len=l.length;i<len;i++)t.appendChild(toDOM(l[i]))}return t}},{key:"Name",value:function(e){var t,n,i=null!=e&&e.tagName?null==e||null===(t=e.tagName)||void 0===t?void 0:t.toLowerCase():"";if(""!=e.id)return"#"+e.id;if("function"==typeof(null==e||null===(n=e.className)||void 0===n?void 0:n.split)){var r,o=null==e||null===(r=e.className)||void 0===r?void 0:r.split(" ");return i+(null==o?void 0:o.join("."))}return i}},{key:"pathName",value:function(e){var t;return e.id?"#"+e.id:e==(null==e||null===(t=e.ownerDocument)||void 0===t?void 0:t.documentElement)?e.tagName:this.ElementName(e)}},{key:"fullPath",value:function(e,t){if(!e)return"";var n=[],i=1;for(n.push(this.pathName(e));!e.id&&(e=t(e,i))&&!e.id;){i++;var r=this.pathName(e);r&&n.unshift(r)}return n.join(" > ")||""}},{key:"FullPath",value:function(e){return e?this.fullPath(e,(function(e){return e.parentNode})):""}},{key:"FullPathV2",value:function(e){if(e.composed&&e.target&&e.target.shadowRoot){var t=e.composedPath();return this.fullPath(t[0],(function(e,n){return t[n]}))}return e&&e.target?this.FullPath(e.target):""}},{key:"ElementName",value:function(e){if(e&&v(e)){if(e.id)return"#"+e.id;var t;if(e==(null==e||null===(t=e.ownerDocument)||void 0===t?void 0:t.documentElement))return e.tagName;var n,i,r,o,s,a,l,u=null===(n=e.tagName)||void 0===n?void 0:n.toLowerCase();"function"==typeof(null===(i=e.className)||void 0===i?void 0:i.split)&&e.className&&""!=(null===(r=e.className)||void 0===r?void 0:r.trim())&&(u+="."+(null===(o=e.className)||void 0===o||null===(s=o.trim())||void 0===s||null===(a=s.split(" "))||void 0===a||null===(l=a.filter((function(e){return!!e})))||void 0===l?void 0:l.join(".")));for(var c=["data-ls-name","href","name","type"],h=0,d=c.length;h<d;h++){var f=c[h],p=e.getAttribute(f);if(p&&""!=p)return u+"[".concat(f,'="').concat(p,'"]')}return u}}},{key:"recordingElementExcluded",value:function(e){var t=(this.recordingElementsMap||{}).exclude;if(t)for(var n in t)if(e&&e.matches&&e.matches(n))return!0}},{key:"recordingElementIncluded",value:function(e){var t=(this.recordingElementsMap||{}).include;if(t)for(var n in t)if(e&&e.matches&&e.matches(n))return!0}},{key:"recordingElementMasked",value:function(e){var t=(this.recordingElementsMap||{}).mask;if(t)for(var n in t)if(e&&e.matches&&e.matches(n))return!0}},{key:"isElementContentDisabled",value:function(e){var t=this;var n,i=(!(n=e).getAttribute||null===n.getAttribute("data-ls-enabled"))&&(!(!n.getAttribute||null===n.getAttribute("data-ls-disabled"))||!t.recordingElementIncluded(n)&&(!!t.recordingElementExcluded(n)||null));if("boolean"==typeof i)return i;for(;e.parentNode;)if(e=e.parentNode,"boolean"==typeof(i=this.isElementContentDisabled(e)))return i;return!1}},{key:"shouldMaskIMG",value:function(e){return!!this.recordingElementMasked(e)||null!==e.getAttribute("data-ls-mask")}},{key:"maskIMG",value:function(e,t,n){e.a.src=null,e.a["data-ls-img"]=this.disableImage(t,n)}},{key:"disableImage",value:function(e,t){return e.complete?{w:e.width,h:e.height}:(e.onload=function(){t&&t({i:this._lsid,a:{"data-ls-img":{w:this.width,h:this.height}}})},null)}},{key:"GetTextContent",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:128,i=e.childNodes||[],r=0,o=i.length;r<o;r++){var s=i[r];if(!this.isElementContentDisabled(s)&&3==s.nodeType&&(t+=" "+s.textContent).length>n)return t;s.childNodes&&(t=this.GetTextContent(s,t))}return t}},{key:"Content",value:function(e){var t,n;if(!e)return"";if(this.isElementContentDisabled(e))return"";var i=this.GetTextContent(e);if("INPUT"===e.tagName&&e.parentElement){var r=e.parentElement.querySelector("label[for='".concat(e.getAttribute("name"),"']"));r&&!this.isElementContentDisabled(r)?i=this.GetTextContent(r):"LABEL"===e.parentElement.tagName&&(i=this.GetTextContent(e.parentElement))}return(i=null===(t=i)||void 0===t||null===(n=t.replace(/\r?\n|\r/g," "))||void 0===n?void 0:n.trim())&&i.length>64?i.substr(0,59)+"[...]":i}},{key:"GetNodeID",value:function(e){return e&&e._lsid||null}},{key:"IsNode",value:function(e){return"object"===("undefined"==typeof Node?"undefined":h(Node))?e instanceof Node:e&&"object"===h(e)&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName}}]),e}(),gt=function(){function e(){W(this,e),this.Reset()}return X(e,[{key:"Reset",value:function(){this.time=this.Now()}},{key:"Duration",value:function(){return this.Now()-this.time}},{key:"Now",value:function(){return(new Date).getTime()}},{key:"IsValidDateObject",value:function(e){return e instanceof Date&&!isNaN(e.valueOf())}},{key:"IsDate",value:function(e){return this.IsValidDateObject(new Date(e))}}]),e}(),yt=function(){function e(){this.Time=new gt,this.DOM=new mt,this.platform=vt()}return e.prototype.StarifyString=function(e){if(!e)return e;for(var t="",n=0;n<e.length;n++){var i="*";" "===e[n]&&(i=" "),t+=i}return t},e.prototype.UUID=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))},e.prototype.ArrayEqual=function(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!=t.length)return!1;for(var n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0},e.prototype.getSystemInfo=function(){var e,t;return{resolution:{width:window.screen.width,height:window.screen.height},browser:{name:vt().name,version:null===vt()||void 0===vt()?void 0:vt().version,description:null===vt()||void 0===vt()?void 0:vt().description},os:{name:null===(e=null===vt()||void 0===vt()?void 0:vt().os)||void 0===e?void 0:e.family,version:null===(t=null===vt()||void 0===vt()?void 0:vt().os)||void 0===t?void 0:t.version},product:null===vt()||void 0===vt()?void 0:vt().product,device:this.getDeviceType()}},e.prototype.getWindowSize=function(){return[Math.max(window.innerWidth||0),Math.max(window.innerHeight||0)]},e.prototype.findFavIconHref=function(){var e=document.querySelector("link[rel=icon]");return e?e.getAttribute("href"):""},e.prototype.getUTMParams=function(){return{source:U("utm_source")||"",medium:U("utm_medium")||"",campaign:U("utm_campaign")||"",term:U("utm_term")||"",content:U("utm_content")||""}},e.prototype.getBaseURL=function(){var e=document.querySelector("base");if(e){var t=e.getAttribute("href");if(t&&""!=t)return t}return new RegExp(/^.*\//).exec(window.location.href)[0]},e.prototype.getCurrentURL=function(){return document&&document.location&&document.location.href},e.prototype.getDeviceType=function(){return/(?:phone|windows\s+phone|ipod|blackberry|(?:android|bb\d+|meego|silk|googlebot) .+? mobile|palm|windows\s+ce|opera\ mini|avantgo|mobilesafari|docomo)/gi.test(navigator.userAgent)?"Mobile":/(?:ipad|playbook|(?:android|bb\d+|meego|silk)(?! .+? mobile))/gi.test(navigator.userAgent)?"Tablet":"Desktop"},e}(),bt=function(){return bt=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},bt.apply(this,arguments)},wt=function(e,t,n){if(n||2===arguments.length)for(var i,r=0,o=t.length;r<o;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},St=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];V.apply(void 0,wt(["EventsStream"],e,!1))},Et=function(){function e(e){var t=e.conditions,n=e.utils,i=e.activity;this.events=[],this.conditions=null,this.enabled=!0,this.activity=null,this.Clear(),this.conditions=t,this.utils=n,this.enabled=!0,this.activity=i}return e.prototype.Enable=function(){this.enabled=!0},e.prototype.Disable=function(){this.enabled=!1},e.prototype.IsEmpty=function(){return 0===this.events.length},e.prototype.Events=function(){return this.events},e.prototype.Clear=function(){this.events=[]},e.prototype.isEnabled=function(){return this.enabled},e.prototype.All=function(){var e=wt([],this.events,!0);return this.events=[],e},e.prototype.Dump=function(e){return wt([],this.events.splice(0,e),!0)},e.prototype.Join=function(e){this.events=wt(wt([],this.events,!0),e,!0)},e.prototype.Add=function(e,t,n){void 0===n&&(n=this.utils.Time.Duration());var i={kind:Ee(e),time:n};t&&(t.el&&(i.el=t.el),t.path&&(i.path=t.path),t.txt&&(i.txt=t.txt),t.x&&(i.x=parseInt(t.x,10)),t.y&&(i.y=parseInt(t.y,10)),t.json_data&&(i.json_data=JSON.stringify(t.json_data)),t.location&&(i.location=t.location),t.value&&(i.value=t.value),t.width&&(i.width=parseInt(t.width,10)),t.height&&(i.height=parseInt(t.height,10)));var r=!this.isEnabled();if(this.conditions.CheckEventData(bt({name:e},i)),this.isEnabled()){if(r&&this.conditions.EventsConditions().includes(e))return void St(e,"omit event with previous disabled events stream");var o=function(e){return void 0===e&&(e={}),!(e.x&&e.x<0||e.y&&e.y<0)}(t);if(!o)return;this.events.push(i),this.activity.applyEvent(e,n),St(e,function(e,t,n){if(!t)return null;var i={t:n};return t.x&&(i.x=t.x),t.y&&(i.y=t.y),t.json_data&&(i.json_data=t.json_data),t.location&&(i.location=t.location),t.width&&(i.width=t.width),t.height&&(i.height=t.height),t.txt&&(i.txt=t.txt),t.value&&(i.value=t.value),i}(0,t,n))}},e}(),kt=function(){function e(t){W(this,e),this.events=t}return X(e,[{key:"Size",value:function(){return this.events.length}},{key:"IsEmpty",value:function(){return 0===this.Size()}},{key:"Events",value:function(){return this.events}}]),e}(),Ot=1024,It=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];V.apply(void 0,["EventsBundler"].concat(t))},Rt=function e(t){W(this,e),this.type=t},xt=function(){function e(t){var n=t.eventsStream,i=t.transport,r=t.globalEvents,o=t.activity,s=t.pageView;W(this,e),this.eventsStream=n,this.transport=i,this.globalEvents=r,this.activity=o,this.pageView=s,this.activityTimeSum=0,this.ticker=new ae({interval:2e3}),this.Reset(),window.addEventListener("beforeunload",this.onUnload.bind(this),!1),window.addEventListener("unload",this.onUnload.bind(this),!1)}return X(e,[{key:"Reset",value:function(){this.seq=0}},{key:"onUnload",value:function(e){"string"==typeof this.pageView.ID()?this.send(!0):this.send(!0,new Rt("beacon_invalid_page_view_id"))}},{key:"Start",value:function(){this.ticker.Start(this.send.bind(this))}},{key:"Stop",value:function(){this.ticker.Stop()}},{key:"nextSequence",value:function(){this.seq++}},{key:"sequence",value:function(){return this.seq}},{key:"send",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1?arguments[1]:void 0,i=new kt(this.eventsStream.Dump(Ot));if(!i.IsEmpty()){var r=this.activity.getActivityTime({flush:!0});It("Snapshot size:",i.Size(),"activeTime:",r),this.transport.SendBundle(i.Events(),(function(){e.nextSequence()}),(function(t){return t&&"session_expired"==t.type?e.Stop():i.Size()>Ot?(e.eventsStream.Clear(),e.Stop(),e.globalEvents.call("bundler.stream_overflow")):void e.eventsStream.Join(i.Events())}),{seq:this.sequence(),ad:r},t,n)}}}]),e}(),Ct=["MouseMove","TouchMove","MouseClick","ValueChange","LocationChange","WindowScroll","Scroll"],Nt=function(){function e(t){var n=t.utils;W(this,e),this.utils=n,this.init()}return X(e,[{key:"init",value:function(){this.inited=!1,this.lastActiveEventTime=0,this.events=[],this.activeTime=0}},{key:"isUserActionEvent",value:function(e){return Ct.indexOf(e)>-1}},{key:"applyEvent",value:function(e,t){var n=this.isUserActionEvent(e);n&&this.events.push({name:e,time:t,isActive:n})}},{key:"getActivityTime",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{flush:!1},n=t.flush;this.activeTime=0;var i=this.events.sort((function(e,t){return e.time-t.time}));i.forEach((function(t){var n=t.time,i=t.isActive,r=n-e.lastActiveEventTime;e.inited&&i&&r<4e3&&(e.activeTime+=r),i&&(e.lastActiveEventTime=n,e.inited=!0)}));var r=this.activeTime>0?this.activeTime:0;return n&&this.flush(),r}},{key:"flush",value:function(){this.activeTime=0,this.events=[]}}]),e}(),_t=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];V.apply(void 0,["Visitor"].concat(t))},At=function(){function e(t){var n=t.utils,i=t.options;W(this,e),this.utils=n,this.options=i}return X(e,[{key:"Load",value:function(){this.id=a.get(this.cookieVisitorID());var e=(a.get(this.cookieSessionID())||"").split(":");this.sessionID=e[0],this.clusterID=e[1]||"",this.sessionTimestamp=Number(a.get(this.cookieSessionExp())),_t("VisitorID:",this.id,"SID:",this.sessionID,"SEXP:",this.sessionTimestamp,"CID:",this.clusterID)}},{key:"getSessionIDWithClusterID",value:function(){return this.sessionID+":"+this.clusterID}},{key:"setCookie",value:function(e,t){a.set(e,t,{expires:3650,domain:this.options.Get("rootHostname"),sameSite:"Lax"}),_t("Set cookie:",e,t,{expires:3650,domain:this.options.Get("rootHostname")})}},{key:"Set",value:function(e,t,n,i){this.sessionID=t,this.id=e,this.sessionTimestamp=n,this.clusterID=i,this.setCookie(this.cookieVisitorID(),this.id),this.setCookie(this.cookieSessionID(),this.getSessionIDWithClusterID()),this.setCookie(this.cookieSessionExp(),this.sessionTimestamp),_t("Set:",this.id,this.sessionID,this.sessionTimestamp,this.clusterID)}},{key:"CleanUpSession",value:function(){a.remove(this.cookieSessionID()),a.remove(this.cookieSessionExp())}},{key:"ID",value:function(){return this.id}},{key:"ClusterID",value:function(){return this.clusterID}},{key:"SessionID",value:function(){return this.sessionID}},{key:"IsValid",value:function(){var e=this.SessionExpiration();return!!this.ID()&&!!this.SessionID()&&!!e&&1e3*e>this.utils.Time.Now()}},{key:"InvalidateSession",value:function(){var e=parseInt(this.utils.Time.Now()/1e3)-3e4;this.sessionTimestamp=e,this.setCookie(this.cookieSessionExp(),e)}},{key:"SessionExpiration",value:function(){return this.sessionTimestamp}},{key:"JSON",value:function(){return{ls_vid:this.ID(),ls_sid:this.SessionID(),ls_sexp:this.SessionExpiration(),ls_clsid:this.ClusterID()}}},{key:"cookieVisitorID",value:function(){return this.withCookieSuffix("__ls_uid")}},{key:"cookieSessionID",value:function(){return this.withCookieSuffix("__ls_sid")}},{key:"cookieSessionExp",value:function(){return this.withCookieSuffix("__ls_exp")}},{key:"withCookieSuffix",value:function(e){return this.options.Get("rootHostname")?"".concat(e,"-").concat(this.options.TrackID()):e}}]),e}(),Tt=function(){return Tt=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},Tt.apply(this,arguments)},Dt=function(){function e(e){var t=e.utils,n=e.options;this.utils=t,this.options=n,this.settings={consoleLogs:!1,networkLogs:!1,networkAllowList:[],minTimeOnPage:0,recordingElementsMap:null}}return e.prototype.Set=function(e){this.settings={consoleLogs:e.consoleLogs||!1,networkLogs:e.networkLogs||!1,minTimeOnPage:e.minTimeOnPage||0,networkAllowList:e.networkAllowList||[],recordingElementsMap:e.recordingElementsMap||null},e&&e.recordingElements&&e.recordingElements.list&&(this.settings.recordingElementsMap=e.recordingElements.list.reduce((function(e,t){return t.enabled?(e[t.match_type]||(e[t.match_type]={}),e[t.match_type][t.element]=!0,Tt({},e)):Tt({},e)}),{}))},e.prototype.Settings=function(){return this.settings},e}(),Lt=function(){return Lt=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},Lt.apply(this,arguments)},Mt=function(){function e(e){var t=e.utils;this.id=-1,this.creationTimestamp=0,this.isNewSession=!1,this.utils=t||new yt,this.pageViewOptions={}}return e.prototype.ID=function(){return this.id},e.prototype.CreationTimestamp=function(){return this.creationTimestamp},e.prototype.IsNewSession=function(){return this.isNewSession},e.prototype.SetID=function(e){this.id=e},e.prototype.SetCreationTimestamp=function(e){this.creationTimestamp=e},e.prototype.SetSessionState=function(e){this.isNewSession=e},e.prototype.SetPageViewOptions=function(e){this.pageViewOptions=e||{}},e.prototype.GetPageViewInfo=function(e){var t=this.utils.getWindowSize(),n=t[0],i=t[1];return Lt(Lt({},this.utils.getSystemInfo()),{utm:this.utils.getUTMParams(),page_view:{title:e.title||document.title,viewport:{width:window.innerWidth,height:window.innerHeight},location:this.location(),page:{width:n,height:i,icon:this.getFaviconURL()}}})},e.prototype.location=function(){var e=this.GetBaseURL(),t={origin:window.location.origin,href:window.location.href,referrer:document.referrer,base:e};if(this.pageViewOptions.baseURL&&e){try{t.origin=new URL(e).origin}catch(n){t.origin=e}try{t.href=new URL(new URL(window.location.href).pathname,e).href}catch(e){}}return t},e.prototype.GetBaseURL=function(){var e=this.pageViewOptions.baseURL;if(e&&"string"==typeof e)return e;var t=this.utils.getBaseURL();return e&&"function"==typeof e&&(t=e(t)),t},e.prototype.getFaviconURL=function(){var e=this.utils.findFavIconHref();return""!=e&&"/"==e[0]?this.GetBaseURL()+e:e},e}();function Pt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function jt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}var Vt=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];V.apply(void 0,["handlers"].concat(t))},Ht=function(){function e(){W(this,e),this.handlers={},this.shadowHandlersEvents=[]}return X(e,[{key:"Register",value:function(e,t){t.setName(e),this.handlers[e]=t,t.supportShadow&&this.shadowHandlersEvents.push(e)}},{key:"CleanUp",value:function(){u()(this.handlers,(function(e,t){return e.Unregister()}))}},{key:"Init",value:function(){var e=[];return u()(this.handlers,(function(t,n){t.isDOMListener&&t.isDOMListener()&&t.Unregister();var i=t.Register();i&&(Array.isArray(i)?e=e.concat(i):e.push(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jt(Object(n),!0).forEach((function(t){Pt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({kind:Ee(n)},i)))})),e}},{key:"Get",value:function(e){return this.handlers[e]}},{key:"IsSet",value:function(e){return null!=this.handlers[e]}},{key:"AddShadowListeners",value:function(e){var t=this;this.shadowHandlersEvents.forEach((function(n){var i=t.Get(n);i&&"function"==typeof i.AddListener?i.AddListener(e):Vt("Error: AddListener does not exists")}))}},{key:"RemoveShadowListeners",value:function(e){var t=this;this.shadowHandlersEvents.forEach((function(n){var i=t.Get(n);i&&"function"==typeof i.RemoveListener?i.RemoveListener(e):Vt("Error: RemoveListener does not exists")}))}}]),e}();function Ut(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=te(e);if(t){var r=te(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ee(this,n)}}var Ft=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];V.apply(void 0,["css-change"].concat(t))},qt=function(e){Z(n,e);var t=Ut(n);function n(e){var i,r=e.utils,o=e.eventsStream,s=e.hooks,a=e.throttleMax,l=e.throttleInterval;return W(this,n),(i=t.call(this)).utils=r,i.hooks=s,i.eventsStream=o,i.cssMap=new WeakMap,i.nextId=1,i.watchedEvents={},i.throttle=new at({interval:l,limit:a,onLimit:function(){i.debug("Warning: CSS changes throttled!")}}),i}return X(n,[{key:"Register",value:function(){}},{key:"Init",value:function(){var e=this;this.watchedEvents.insertRule=this.hooks.Create(window.CSSStyleSheet.prototype,"insertRule",{after:function(){var t=arguments,n=this;j((function(){e.throttle.Use((function(){var i=e.utils.DOM.GetNodeID(n.ownerNode);i?e.insertRule(i,t[0],t[1]):setTimeout((function(){i=e.utils.DOM.GetNodeID(n.ownerNode),e.insertRule(i,t[0],t[1])}),0)}))}))}}),this.watchedEvents.deleteRule=this.hooks.Create(window.CSSStyleSheet.prototype,"deleteRule",{after:function(){var t=arguments,n=this;j((function(){e.throttle.Use((function(){var i=e.utils.DOM.GetNodeID(n.ownerNode);e.deleteRule(i,t[0])}))}))}}),this.addAdoptedStyleSheetsHooks();var t=this.snapshot({styleOnly:!0,contentLessOnly:!0});this.eventsStream.Add(this.name,{json_data:t})}},{key:"Unregister",value:function(){this.watchedEvents.insertRule&&this.hooks.Unbind(this.watchedEvents.insertRule),this.watchedEvents.deleteRule&&this.hooks.Unbind(this.watchedEvents.deleteRule),this.cssMap=new WeakMap}},{key:"Handler",value:function(e){this.eventsStream.Add(this.name)}},{key:"addAdoptedStyleSheets",value:function(e,t){this.addAdoptedStyleSheetsEvent(e,t)}},{key:"sheetRules",value:function(e){try{return e.cssRules||e.rules}catch(e){return!1}}},{key:"snapshot",value:function(e){for(var t=e.styleOnly,n=void 0!==t&&t,i=e.contentLessOnly,r=void 0!==i&&i,o=[],s=0;s<document.styleSheets.length;s++){var a=document.styleSheets[s],l=this.sheetRules(a),u=this.utils.DOM.GetNodeID(a.ownerNode);if((!n||"STYLE"===a.ownerNode.tagName)&&((!r||""===a.ownerNode.textContent)&&l))for(var c=0;c<l.length;c++){var h="";try{h=a.cssRules[c].cssText}catch(e){}""!=h&&o.push({lsid:u,i:s,d:h})}}return{t:2,d:o}}},{key:"insertRule",value:function(e,t,n){var i={lsid:e,t:0,i:n,d:t};this.eventsStream.Add(this.name,{json_data:i})}},{key:"deleteRule",value:function(e,t){var n={lsid:e,t:1,i:t};this.eventsStream.Add(this.name,{json_data:n})}},{key:"addAdoptedStyleSheetsEvent",value:function(e,t,n){if(e&&t&&t.length){for(var i=[],r=0;r<t.length;r++){var o=t[r];if(o){var s=this.cssMap.get(o);if(s)i.push({i:s});else{var a=this.sheetRules(o);if(a){for(var l=[],u=0;u<a.length;u++){var c,h=null===(c=a[u])||void 0===c?void 0:c.cssText;h&&l.push({d:h,i:u})}i.push({i:this.nextId,r:l}),this.cssMap.set(o,this.nextId),this.nextId++}else Ft("rules not found")}}else Ft("sheet not found")}if(i.length){var d={lsid:e,t:3,i:n,d:i};this.eventsStream.Add(this.name,{json_data:d})}}}},{key:"onAddAdoptedStyleSheetsProto",value:function(e,t){var n=this.utils.DOM.GetNodeID(e);n&&this.addAdoptedStyleSheets(n,t)}},{key:"addAdoptedStyleSheetsHooks",value:function(){var e=this,t=Object.getOwnPropertyDescriptor(window.ShadowRoot.prototype,"adoptedStyleSheets"),n=Object.getOwnPropertyDescriptor(window.Document.prototype,"adoptedStyleSheets"),i=function(t){return{get:function(){return t.get.call(this)},set:function(n){t.set.call(this,n),e.onAddAdoptedStyleSheetsProto(this,n)},enumerable:!0,configurable:!0}};t&&Object.defineProperty(window.ShadowRoot.prototype,"adoptedStyleSheets",i(t)),n&&Object.defineProperty(window.Document.prototype,"adoptedStyleSheets",i(n))}}]),n}(oe),Bt=function(){function e(){this.accountID="-1",this.websiteID="-1",this.settings={keystrokes:!1,rootHostname:null,minDuration:0}}return e.prototype.AccountID=function(){return this.accountID},e.prototype.SetAccountID=function(e){this.accountID=e,window.__lsAID=e},e.prototype.WebsiteID=function(){return this.websiteID},e.prototype.TrackID=function(){return"".concat(this.accountID,".").concat(this.websiteID)},e.prototype.SetWebsiteID=function(e){this.websiteID=e,window.__lsWID=e},e.prototype.Get=function(e){return this.settings[e]},e.prototype.Set=function(e,t){this.settings[e]=t},e}(),Wt=function(){function e(e,t,n){void 0===n&&(n={}),this.native=e[t],this.proto=e,this.fn=t,n.after&&this.After(n.after),n.afterAsync&&this.AfterAsync(n.afterAsync),n.before&&this.Before(n.before),this.Bind()}return e.prototype.Bind=function(){var e=this;this.proto[this.fn]=function(){var t=this;e.before&&e.before.apply(this,arguments);var n=e.native.apply(this,arguments);return e.after&&e.after.apply(this,arguments),e.afterAsync&&setTimeout((function(){return e.afterAsync.apply(t,arguments)}),0),n}},e.prototype.Unbind=function(){this.proto[this.fn]=this.native},e.prototype.After=function(e){this.after=e},e.prototype.AfterAsync=function(e){this.afterAsync=e},e.prototype.Before=function(e){this.before=e},e}(),Gt=function(){function e(){this.hooks={}}return e.prototype.CanBind=function(e,t){return!!e&&!!e[t]},e.prototype.Create=function(e,t,n){if(this.hooks[t])return this.hooks[t];var i=new Wt(e,t,n);return this.hooks[t]=i,i},e.prototype.Unbind=function(e){e.Unbind(),this.hooks[e.fn]=null},e}(),Xt=function(){function e(t){var n=this,i=t.utils,r=t.eventsStream,o=t.aquireInterval,s=(t.setInterval,t.options),a=t.globalEvents;W(this,e),this.utils=i,this.options=s,this.eventsStream=r,this.values={},this.inputs={},this.ticker=new ae({interval:o}),a.on("handlers.".concat(me.MUTATION,".inited"),(function(e,t,i){n.mirror=i,n.registered||n.Register()})),this.fallback=!1,this.registered=!1}return X(e,[{key:"unregisterInput",value:function(e,t){this.inputs[t]&&delete this.inputs[t],e&&(e.removeEventListener("change",this.ChangeHandler.bind(this),!0),e.removeEventListener("input",this.ChangeHandler.bind(this),!0),e.removeEventListener("blur",this.SetHandler.bind(this),!0),e._lsWatched=!1)}},{key:"registerInput",value:function(e,t){this.inputs[t]=e,e._lsWatched||(e.addEventListener("change",this.ChangeHandler.bind(this),!0),e.addEventListener("input",this.ChangeHandler.bind(this),!0),e.addEventListener("blur",this.SetHandler.bind(this),!0),e._lsWatched=!0)}},{key:"watchInputNode",value:function(e){var t=this.mirror.knownNodes.get(e);t&&this.registerInput(e,t)}},{key:"watchProperty",value:function(e,t){var n=Object.getOwnPropertyDescriptor(e,t),i=this;n&&Object.defineProperty(e,t,{set:function(e){var t=this;return j((function(){i.setNodeValue(t,e)})),n.set.call(this,e)},get:function(){return n.get&&n.get.call(this)}})}},{key:"Register",value:function(){var e=Object.getOwnPropertyDescriptor(HTMLInputElement.prototype,"value");e&&e.set?(this.watchProperty(HTMLInputElement.prototype,"value"),this.watchProperty(HTMLInputElement.prototype,"checked"),this.watchProperty(HTMLSelectElement.prototype,"value"),this.watchProperty(HTMLTextAreaElement.prototype,"value")):this.fallback=!0,this.ticker.Start(this.handleInterval.bind(this)),this.registered=!0}},{key:"ChangeHandler",value:function(e){this.setNodeValue(e.target)}},{key:"SetHandler",value:function(e){var t=e.target;if(this.canRecordValues(t)){var n=this.mirror.knownNodes.get(t),i=this.getElementValue(t);if(t._lsLastValue===i)return;this.eventsStream.Add(me.VALUE_SET,{value:i,path:this.utils.DOM.FullPath(t),el:this.utils.DOM.ElementName(t),json_data:{lsid:n}}),t._lsLastValue=i}}},{key:"setNodeValue",value:function(e,t){var n=this.getElementValue(e,t);if(null!==n){var i=this.mirror.knownNodes.get(e);i&&(this.values[i]={value:n,path:this.utils.DOM.FullPath(e),el:this.utils.DOM.ElementName(e),json_data:{lsid:i}})}}},{key:"handleInterval",value:function(){var e=this;u()(this.values,(function(t,n){e.eventsStream.Add(me.VALUE_CHANGE,t)})),this.values={}}},{key:"canRecordValues",value:function(e){return null==e.getAttribute("data-ls-disabled")&&(null!=e.getAttribute("data-ls-enabled")||this.options.Get("keystrokes"))}},{key:"getElementValue",value:function(e,t){var n=e.getAttribute("type"),i=this.canRecordValues(e),r=e.getAttribute("autocomplete"),o=null==t||void 0===t?e.value:t;if(["cc-additional-name","cc-csc","cc-exp-month","cc-exp-year","cc-exp","cc-family-name","cc-given-name","cc-name","cc-number","cc-type"].indexOf(r)>-1)return null;if(r&&0===r.indexOf("cc-"))return null;if(n)switch(n.toLowerCase()){case"checkbox":case"radio":return(null!=t||void 0!==t?!!t+0:e.checked+0)+"";case"number":case"date":case"datetime-local":case"time":case"week":case"month":case"range":return i?o:null;case"file":case"hidden":case"password":return null;case"submit":return o;default:return i?o:this.utils.StarifyString(o)}return i?o:this.utils.StarifyString(o)}}]),e}(),zt=function(){function e(t){var n=this,i=t.utils,r=t.eventsStream,o=t.options,s=t.globalEvents;W(this,e),this.utils=i,this.options=o,this.eventsStream=r,this.forms={},s.on("handlers.".concat(me.MUTATION,".inited"),(function(e,t,i){n.mirror=i}))}return X(e,[{key:"unregisterForm",value:function(e,t){this.forms[t]&&delete this.forms[t],e&&(e.removeEventListener("submit",this.Handler.bind(this),!0),e._lsWatched=!1)}},{key:"registerForm",value:function(e,t){this.forms[t]=e,e._lsWatched||(e.addEventListener("submit",this.Handler.bind(this),!0),e._lsWatched=!0)}},{key:"watchFormNode",value:function(e){var t=this.mirror.knownNodes.get(e);t&&this.registerForm(e,t)}},{key:"Handler",value:function(e){var t=this.mirror.knownNodes.get(e.target);this.eventsStream.Add(me.FORM_SUBMIT,{path:this.utils.DOM.FullPath(e.target),el:this.utils.DOM.ElementName(e.target),json_data:{lsid:t}})}}]),e}();function Yt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=te(e);if(t){var r=te(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ee(this,n)}}var Kt=null,$t=null,Jt=function(e){Z(n,e);var t=Yt(n);function n(e){var i,r=e.utils,o=e.eventsStream,s=e.aquireInterval;return W(this,n),(i=t.call(this)).startTime=null,i.lastPosition={x:0,y:0},i.position={x:0,y:0},i.utils=r,i.eventsStream=o,i.ticker=new ae({interval:s}),i.eventFunc=function(e){return j(i.Handler.bind(J(i)),e)},i}return X(n,[{key:"Register",value:function(){return this.startTime=null,window.addEventListener("touchstart",this.eventFunc,!0),window.addEventListener("touchend",this.eventFunc,!0),window.addEventListener("touchmove",this.eventFunc,!0),window.addEventListener("touchcancel",this.eventFunc,!0),this.ticker.Start(this.Trigger.bind(this)),this.Get()}},{key:"Unregister",value:function(){this.startTime=null,window.addEventListener("touchstart",this.eventFunc,!0),window.addEventListener("touchend",this.eventFunc,!0),window.addEventListener("touchmove",this.eventFunc,!0),window.addEventListener("touchcancel",this.eventFunc,!0),this.ticker.Stop()}},{key:"isValueChanged",value:function(){var e=this.lastPosition,t=e.x,n=e.y;return t!=this.position.x||n!=this.position.y}},{key:"Handler",value:function(e,t){if(this.startTime||(this.startTime=this.utils.Time.Duration()),void 0!==e.changedTouches)for(var n=0;n<e.changedTouches.length;++n){var i=e.changedTouches[n],r=parseInt(i.clientX,10),o=parseInt(i.clientY,10),s=parseInt(i.pageX,10),a=parseInt(i.pageY,10);Kt=parseInt(i.clientX,10),$t=parseInt(i.clientY,10),this.position={x:r,y:o,json_data:{rx:s,ry:a}}}}},{key:"Trigger",value:function(){this.isValueChanged()?(this.lastPosition={x:this.position.x,y:this.position.y,json_data:this.position.json_data},this.eventsStream.Add(this.name,this.position,this.startTime),this.startTime=null):this.startTime=null}},{key:"Get",value:function(){return null!=Kt&&null!=$t?{x:Kt,y:$t}:null}}]),n}(se),Qt=function(){function e(t){var n=t.globalEvents;W(this,e),this.enabled={},this.list={},this.globalEvents=n}return X(e,[{key:"Register",value:function(e,t){this.list[e]=t}},{key:"SetEnabledList",value:function(e){var t=this;this.enabled=e||{},u()(this.list,(function(e,n){var i=t.enabled[n];i&&i.enabled&&(e.Enable(),e.setProps(i.properties))}))}},{key:"Scan",value:function(){var e=this;u()(this.list,(function(t,n){e.enabled[n]&&t.scan()}))}}]),e}();function Zt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function en(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Zt(Object(n),!0).forEach((function(t){Pt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var tn=function(){function e(t){var n=t.globalEvents,i=t.name;W(this,e),this.name=i,this.props={},this.globalEvents=n,this.installed=!1,this.enabled=!1,this.ticker=new ae({interval:1e3})}return X(e,[{key:"debug",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];V.apply(void 0,[this.name].concat(t))}},{key:"setName",value:function(e){this.name=e}},{key:"Enable",value:function(){this.enabled=!0}},{key:"Disable",value:function(){this.enabled=!1}},{key:"setInstalled",value:function(){this.globalEvents.call("integration.installed",{name:this.name,props:this.props}),this.installed=!0}},{key:"setProps",value:function(e){this.debug("props set:",e),this.props=en(en({},this.props),e)}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isInstalled",value:function(){return this.installed}},{key:"scan",value:function(){var e=this;if(!this.isInstalled())if(this.check())this.setInstalled();else{var t=0;this.ticker.Start((function(){t>e.maxAttemps&&e.ticker.Stop(),e.check()&&(e.setInstalled(),e.ticker.Stop()),t++}))}}}]),e}();function nn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=te(e);if(t){var r=te(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ee(this,n)}}var rn,on,sn,an=function(e){Z(n,e);var t=nn(n);function n(e){var i,r=e.utils,o=e.maxAttemps,s=e.globalEvents,a=e.xhrTransport,l=e.visitor,u=e.JSAPI;return W(this,n),(i=t.call(this,{globalEvents:s,name:"Intercom"})).utils=r,i.maxAttemps=o,i.xhrTransport=a,i.visitor=l,i.JSAPI=u,i.inited=!1,i.propsSended=!1,i.properties={profile_link:!1,event_link:!1},i}return X(n,[{key:"check",value:function(){if("function"==typeof window.Intercom){var e=window.Intercom("getVisitorId");return!!e&&(this.setProps({visitor_id:e}),this.props["link.event"]&&this.JSAPI.getSessionURL((function(e,t){t&&window.Intercom("trackEvent","LiveSession",{sessionURL:e})})),this.props["link.profile"]&&this.JSAPI.getSessionURL((function(e,t){t&&window.Intercom("update",{livesessionURL:e})})),!0)}return!1}}]),n}(tn),ln=[String,Number,Boolean],un=function(e){return!function(e){return null!=e}(e)||~ln.indexOf(e.constructor)},cn=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if((n=isNaN(n)?n:{maxDepth:n}).maxDepth=n.maxDepth||rn,n.replace=n.replace||sn,i<n.maxDepth){var r=i+1;if(un(t))return t;if(Array.isArray(t)){var o=[];return t.length>n.maxKeys/Math.pow(2,i)&&(t=t.slice(0,n.maxKeys/Math.pow(2,i))).push(n.replace),t.map((function(t){un(t)?void 0!==t&&t.constructor==String&&t.length>n.maxString?o.push(t.substr(0,n.maxString)+"[...]"):o.push(t):o.push(e(t,n,r))})),o}var s={},a=0;for(var l in t)if(a<n.maxKeys/Math.pow(2,i))try{a++,un(t[l])?void 0!==t[l]&&t[l].constructor==String&&t[l].length>n.maxString?s[l]=t[l].substr(0,n.maxString)+"[...]":s[l]=t[l]:s[l]=e(t[l],n,r)}catch(e){}else s.__lsMaxKeys__=!0;return s}return n.replace};cn.config=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};rn=e.maxDepth||rn,on=e.maxString||on,sn=e.replace||sn},cn.reset=function(){rn=10,on=256,sn=void 0},cn.reset();var hn=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),dn=function(e){function t(t){var n=t.utils,i=t.eventsStream,r=t.options,o=t.hooks,s=t.globalEvents,a=t.enabled,l=e.call(this)||this;return l.utils=n,l.options=r,l.eventsStream=i,l.hooks=o,l.globalEvents=s,l.errorFunc=function(e){return j(l.ErrorHandlder.bind(l),e)},l.exceptionFunc=function(e){return j(l.ExceptionHandler.bind(l),e)},l.maxLogsPerPage=256,l.maxErrorsPerPage=256,l.maxObjDepth=3,l.maxObjKeys=32,l.maxStringLength=128,l.watchedEvents={},l.buff=[],l.enabled=a||!1,l.inited=!1,l}return hn(t,e),t.prototype.Register=function(){var e=this;window.addEventListener("error",this.errorFunc,!0),window.addEventListener("unhandledrejection",this.exceptionFunc,!0),this.logCounter=0,this.errCounter=0,this.logReached=!1,this.errReached=!1;var t=this;this.hooks.CanBind(console,"log")&&(this.watchedEvents={warn:this.hooks.Create(console,"warn",{before:function(){t.Console("warn",arguments)}}),error:this.hooks.Create(console,"error",{before:function(){t.Console("error",arguments)}}),log:this.hooks.Create(console,"log",{before:function(){t.Console("log",arguments)}}),info:this.hooks.Create(console,"info",{before:function(){t.Console("info",arguments)}})}),this.globalEvents.once("api.session.inited",(function(t){var n=t.settings;e.inited=!0,e.enabled=n.consoleLogs,e.enabled?e.buff.length&&(u()(e.buff,(function(t){e.eventsStream.Add(t.type,t.obj,t.time)})),e.buff=[]):e.buff=[]}))},t.prototype.addEvent=function(e,t){this.enabled&&this.eventsStream.Add(e,t),this.inited||this.buff.push({type:e,obj:t,time:this.utils.Time.Duration()})},t.prototype.Unregister=function(){window.removeEventListener("error",this.errorFunc,!0),window.removeEventListener("unhandledrejection",this.exceptionFunc,!0),this.watchedEvents.warn&&this.hooks.Unbind(this.watchedEvents.warn),this.watchedEvents.error&&this.hooks.Unbind(this.watchedEvents.error),this.watchedEvents.log&&this.hooks.Unbind(this.watchedEvents.log),this.watchedEvents.info&&this.hooks.Unbind(this.watchedEvents.info)},t.prototype.ErrorHandlder=function(e){if(!this.isMax("err",this.maxErrorsPerPage)){var t=e.message,n=e.filename,i=e.lineno,r=fn(e.error),o=n||i||r?[n,i,r]:null;(t||n||i||r)&&this.addEvent(me.ERROR,{value:t,json_data:o})}},t.prototype.ExceptionHandler=function(e){this.isMax("err",this.maxErrorsPerPage)||this.addEvent(me.ERROR,{value:"Uncaught (in promise)",json_data:[e.reason]})},t.prototype.ConsoleError=function(e){this.isMax("err",this.maxErrorsPerPage)||this.addEvent(me.ERROR,{json_data:e})},t.prototype.isMax=function(e,t){return this["".concat(e,"Counter")]>=t?(this["".concat(e,"Reached")]||(this["".concat(e,"Reached")]=!0,this.addEvent(me.LOG,{json_data:[ye.internal,"tracking.console.maxLogs",e]})),!0):(this["".concat(e,"Counter")]++,!1)},t.prototype.parseObject=function(e){return cn(e,{maxString:this.maxStringLength,maxDepth:this.maxObjDepth,maxKeys:this.maxObjKeys,replace:"_max_"})},t.prototype.Console=function(e,t){var n=this;if(!this.isMax("log",this.maxLogsPerPage)){var i=[];if(t){if(window.__ls_debug&&"log"===e&&"string"==typeof t[0]&&"[LS]"===t[0].substr(0,4))return;u()(Array.prototype.slice.call(t,0,this.maxObjKeys),(function(e){i.push(n.parseObject(e))})),e===be.error?this.ConsoleError(i):this.addEvent(me.LOG,{json_data:[ye[e]||-1,i]})}}},t}(se),fn=function(e){if(e&&e.stack){for(var t=/^\s*at (.*?) ?\(((?:file|https?|blob|chrome-extension|native|eval|<anonymous>).*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,n=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)((?:file|https?|blob|chrome|resource|\[native).*?)(?::(\d+))?(?::(\d+))?\s*$/i,i=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:file|ms-appx|https?|blob):.*?):(\d+)(?::(\d+))?\)?\s*$/i,r=e.stack.split("\n"),o=[],s=void 0,a=0,l=void 0,u=r.length;a<u;++a){if(l=t.exec(r[a])){var c=l[2]&&-1!==l[2].indexOf("native");s={url:c?null:l[2],func:l[1]||"?",args:c?[l[2]]:[],line:l[3]?+l[3]:null,column:l[4]?+l[4]:null}}else if(l=i.exec(r[a]))s={url:l[2],func:l[1]||"?",args:[],line:+l[3],column:l[4]?+l[4]:null};else{if(!(l=n.exec(r[a])))continue;s={url:l[3],func:l[1]||"?",args:l[2]?l[2].split(","):[],line:l[4]?+l[4]:null,column:l[5]?+l[5]:null}}!s.func&&s.line&&(s.func="?"),o.push(s)}return o.length?(o[0].column||void 0===e.columnNumber||(o[0].column=e.columnNumber+1),{name:e.name,message:e.message,url:window.location.href,stack:o}):null}};function pn(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,o=[],s=!0,a=!1;try{for(n=n.call(e);!(s=(i=n.next()).done)&&(o.push(i.value),!t||o.length!==t);s=!0);}catch(e){a=!0,r=e}finally{try{s||null==n.return||n.return()}finally{if(a)throw r}}return o}}(e,n)||t(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var vn="int",mn="float",gn="bool",yn="str",bn=[vn,mn,gn,yn];function wn(e){return"number"==typeof e&&!isNaN(e)}function Sn(e,t){switch(t){case yn:return"string"==typeof e;case vn:return wn(e)&&Number.isInteger(e);case mn:return wn(e);case gn:return"boolean"==typeof e;default:return!1}}function En(e){return e.slice(0,256)}function kn(e,t){return t===yn?e.slice(0,256):e}function On(e){return"value_".concat(e)}function In(e){var t=[],n=f(e=e||{},(function(n,i){var r=e[i],o="",s="",a="";if(bn.forEach((function(e){if(!o){var t=function(e,t){var n=t.lastIndexOf(e),i=t.length,r=t.slice(n,n+i)===e,o=[];return r&&o.push(n,i),[r].concat(o)}("_".concat(e),i),n=pn(t,2),r=n[0],l=n[1];o=r,s=i.slice(0,l),a=e}})),o)return Sn(r,a)?Pt({name:En(s)},On(a),kn(r,a)):void t.push("".concat(JSON.stringify(r)," is not typeof ").concat(a));var l=function(e){var t=parseFloat(e),n=parseInt(e);return t===n?Sn(n,vn)?[n,vn]:[]:Sn(t,mn)?[t,mn]:Sn(e,yn)?[e,yn]:Sn(e,gn)?[e,gn]:[]}(r),u=pn(l,2),c=u[0],h=u[1];return h?Pt({name:En(i)},On(h),kn(c,h)):void 0})).filter((function(e){return e&&!!e.name}));return n.length>50?[null,"max custom properties exceeded"]:[n,t.length?t:null]}function Rn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=te(e);if(t){var r=te(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ee(this,n)}}var xn=function(e){Z(n,e);var t=Rn(n);function n(e){var i,r=e.utils,o=e.maxAttemps,s=e.globalEvents,a=e.xhrTransport,l=e.visitor,u=e.options,c=e.JSAPI;return W(this,n),(i=t.call(this,{globalEvents:s,name:"LiveChat"})).utils=r,i.maxAttemps=o,i.xhrTransport=a,i.visitor=l,i.options=u,i.JSAPI=c,i.inited=!1,i.propsSended=!1,i.isLivechatReady=!1,i.properties={},i}return X(n,[{key:"onLivechatReady",value:function(){var e=this.options.AccountID(),t=this.visitor.ID(),n=this.visitor.SessionID();if(t&&n){this.isLivechatReady=!0;var i="".concat(e,".").concat(t,".").concat(n);window.LiveChatWidget.call("set_session_variables",{livesessionData:btoa(i)})}else console.error("(livechat-integration): visitorID and sessionID cannot be empty")}},{key:"check",value:function(){if(this.isLivechatReady)return!0;var e=window.LiveChatWidget;return"object"===h(e)&&e.on&&e.on("ready",this.onLivechatReady.bind(this)),this.isLivechatReady}}]),n}(tn);function Cn(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Nn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Nn(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function Nn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function _n(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=te(e);if(t){var r=te(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ee(this,n)}}var An=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];V.apply(void 0,["PerformanceHandler"].concat(t))},Tn=function(e){Z(n,e);var t=_n(n);function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=i.eventsStream;return W(this,n),(e=t.call(this)).eventsStream=r,e.fcp=null,e.domLoaded=null,e.pageLoaded=null,e.cb=null,e.backOffIntervalMs=500,e.backOffMaxMs=3e4,e.streamBuffer={fcp:null,domLoaded:null,pageLoaded:null},e}return X(n,[{key:"Register",value:function(){}},{key:"Unregister",value:function(){}},{key:"Init",value:function(){this.observe()}},{key:"addEvent",value:function(){var e=this.getPerformanceInfo(),t={};e.fcp&&!this.streamBuffer.fcp&&(t.first_contentful_paint=e.fcp),e.domLoaded&&!this.streamBuffer.domLoaded&&(t.dom_loaded=e.domLoaded),e.pageLoaded&&!this.streamBuffer.pageLoaded&&(t.page_loaded=e.pageLoaded),Object.keys(t).length&&(An("Add Performance Event",JSON.stringify(t)),this.eventsStream.Add(me.PERFORMANCE,{json_data:t}),this.streamBuffer={fcp:e.fcp,domLoaded:e.domLoaded,pageLoaded:e.pageLoaded})}},{key:"getPerformanceInfo",value:function(){return{fcp:this.fcp,domLoaded:this.domLoaded,pageLoaded:this.pageLoaded}}},{key:"observe",value:function(){var e=window.performance;if(e){"PerformanceObserver"in window&&this.observerAPI();var t=e.getEntriesByType("navigation");t&&t.length?this.navigationAPI(t):e.timing&&this.deprecatedTimingAPI()}}},{key:"observerAPI",value:function(){var e=this;An("use PerformanceObserver API");var t=new PerformanceObserver((function(n,i){for(var r,o,s=n.getEntries(),a=0;a<s.length;a++){var l=s[a];if(l instanceof PerformanceNavigationTiming){r=l.domComplete-l.requestStart,o=l.loadEventEnd-l.requestStart;break}}e.domLoaded=e.castPerformanceVal(r),e.pageLoaded=e.castPerformanceVal(o),e.addEvent(),e.domLoaded&&e.pageLoaded&&t.disconnect()}));t.observe({type:"navigation",buffered:!0});var n=new PerformanceObserver((function(t){var i,r=-1,o=Cn(t.getEntriesByName("first-contentful-paint"));try{for(o.s();!(i=o.n()).done;){r=i.value.startTime}}catch(e){o.e(e)}finally{o.f()}e.fcp=e.castPerformanceVal(r),e.addEvent(),e.fcp&&n.disconnect()}));n.observe({type:"paint",buffered:!0})}},{key:"navigationAPI",value:function(e){var t=this;An("use PerformanceNavigationTiming API");for(var n="",i="",r=0;r<e.length;r++){var o=e[r];n=o.domComplete-o.requestStart,i=o.loadEventEnd-o.requestStart}this.domLoaded=this.castPerformanceVal(n),this.pageLoaded=this.castPerformanceVal(i),this.fcp=this.castPerformanceVal(this.getFCP()),this.backOff((function(){return t.domLoaded&&t.pageLoaded}),(function(){return t.addEvent()}))}},{key:"deprecatedTimingAPI",value:function(){var e=this;An("use Timing API");var t=window.performance;this.domLoaded=this.castPerformanceVal(t.timing.domComplete-t.timing.requestStart),this.pageLoaded=this.castPerformanceVal(t.timing.loadEventEnd-t.timing.requestStart),this.fcp=this.castPerformanceVal(this.getFCP()),this.backOff((function(){return e.domLoaded&&e.pageLoaded}),(function(){return e.addEvent()}))}},{key:"getFCP",value:function(){var e=window.performance.getEntriesByType("paint"),t=-1;if(e)for(var n=0;n<e.length;n++)"first-contentful-paint"===e[n].name&&(t=e[n].startTime);return t}},{key:"castPerformanceVal",value:function(e){var t=parseInt(e,10);return!t||isNaN(t)||t<=0?0:t}},{key:"backOff",value:function(e,t){var n=this;if("function"==typeof e&&"function"==typeof t)if(e())t();else var i=+Date.now(),r=0,o=setInterval((function(){if(++r>=10)return clearInterval(o),void t();var s=+Date.now()-i;(e()||s>=n.backOffMaxMs)&&(clearInterval(o),t())}),this.backOffIntervalMs)}}]),n}(oe),Dn=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.backOffIntervalMs,i=t.backOffMaxMs,r=t.maxTicks;W(this,e),this.backOffMaxMs=i||3e3,this.backOffIntervalMs=n||500,this.maxTicks=r||10}return X(e,[{key:"start",value:function(e,t){var n=this;if("function"==typeof e&&"function"==typeof t)if(e())t();else var i=+Date.now(),r=0,o=setInterval((function(){if(++r>=n.maxTicks)return clearInterval(o),void t();var s=+Date.now()-i;(e()||s>=n.backOffMaxMs)&&(clearInterval(o),t())}),this.backOffIntervalMs)}}]),e}();function Ln(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=te(e);if(t){var r=te(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ee(this,n)}}var Mn=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];V.apply(void 0,["TechnologyScan"].concat(t))},Pn=function(e){Z(n,e);var t=Ln(n);function n(e){var i,r;return W(this,n),(r=t.call(this)).backoff=new Dn({backOffIntervalMs:500,backOffMaxMs:3e3}),r.technologies=(Pt(i={},"shopify",(function(){return window.Shopify&&window.Shopify.theme&&!0})),Pt(i,"intercom",(function(){return window.Intercom&&!0})),Pt(i,"livechat",(function(){return window.LiveChatWidget&&!0})),i),r.eventsStream=e,r}return X(n,[{key:"Register",value:function(){}},{key:"Unregister",value:function(){}},{key:"Init",value:function(){this.scan()}},{key:"scan",value:function(){var e=this;Mn("start scanning...");var t=Object.keys(this.technologies),n={};this.backoff.start((function(){return Mn("scanning tick..."),t.forEach((function(i,r){if(Mn("scan ".concat(i," technology")),e.technologies[i]){var o=!!e.technologies[i]();o&&t.splice(r,1),n[i]=o}else t.splice(r,1)})),!t.length}),(function(){Mn("scanned technologies: ",JSON.stringify(n)),e.eventsStream.Add(me.TECHNOLOGY,{json_data:n})}))}}]),n}(oe);function jn(e){var t;try{return new URL(e,null===(t=n.g.window.document)||void 0===t?void 0:t.baseURI).href}catch(e){}return e}function Vn(e){return new Blob([e]).size}var Hn=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Un=function(){return Un=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},Un.apply(this,arguments)},Fn=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(e){o(e)}}function a(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))},qn=function(e,t){var n,i,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=s.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},Bn=function(e,t,n){if(n||2===arguments.length)for(var i,r=0,o=t.length;r<o;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},Wn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];V.apply(void 0,Bn(["DevtoolsNetwork"],e,!1))},Gn=function(e){function t(t){var n=t.utils,i=t.eventsStream,r=t.options,o=t.hooks,s=t.globalEvents,a=e.call(this)||this;return a.filterHeaders=function(e){for(var t=["authorization","proxy-authorization","cookie"],n=0,i=Object.entries(e);n<i.length;n++){var r=i[n],o=r[0],s=r[1];t.includes(o.toLowerCase())?e[o]=a.mask:(null==s?void 0:s.length)>a.maxHeaderLength&&(e[o]="".concat(null==s?void 0:s.slice(0,a.maxHeaderLength)," [...]"))}return e},a.ab2str=function(e){var t="";if(!("TextDecoder"in window)){var n=new TextDecoder("utf-8"),i=new Uint8Array(e);t=n.decode(i)}return t},a.utils=n,a.options=r,a.eventsStream=i,a.hooks=o,a.globalEvents=s,a.networkAllowList=[],a.maxBodyLength=2048,a.maxHeaderLength=1024,a.maxErrorsPerPage=256,a.watchedEvents={},a.buff=[],a.pendingReqs={},a.enabled=!1,a.inited=!1,a.mask="[omitted]",a.logCounter=0,a.errCounter=0,a.NetLogCounter=0,a.NetErrorCounter=0,a.NetErrorReached=!1,a.NetLogReached=!1,a.logReached=!1,a.errReached=!1,a}return Hn(t,e),t.prototype.logIsAllow=function(e){try{var t=jn(e);return t.indexOf("https://rs.livesession.io")>-1?{allowLog:!1,allowLogRequestBody:!1,allowLogResponseBody:!1}:function(e,t){try{var n=(null==e?void 0:e.filter((function(e){return e.rule===we})).length)>0,i=(null==e?void 0:e.filter((function(e){return e.rule===Se})).length)>0;if(!e.length||!n)return{allowLog:!0,allowLogRequestBody:!1,allowLogResponseBody:!1};var r=!1,o=!1,s=null,a=null,l=null;return e.forEach((function(e){if(function(e,t){try{if(null==t?void 0:t.toLowerCase().match(null==e?void 0:e.toLowerCase()))return!0}catch(e){}return!1}(null==e?void 0:e.url_pattern,t))switch(e.rule){case we:r=!0,!1!==a&&(a=null==e?void 0:e.request_body),!1!==l&&(l=null==e?void 0:e.response_body);case Se:o=!0}})),null===s&&(s=i?r&&!o:r),{allowLog:s,allowLogRequestBody:!!a,allowLogResponseBody:!!l}}catch(e){Wn(e)}return{allowLog:!0,allowLogRequestBody:!1,allowLogResponseBody:!1}}(this.networkAllowList,t)}catch(e){Wn(e)}return{allowLog:!1,allowLogRequestBody:!1,allowLogResponseBody:!1}},t.prototype.HandleRequests=function(){if(window.fetch&&window.Promise){var e=this,t=window.fetch;window.fetch=function(){for(var n=this,i=[],r=0;r<arguments.length;r++)i[r]=arguments[r];var o=i[0],s=i[1];s||(s=new Request(o||""));var a=e.addPendingReq(s,null==s?void 0:s.method,o||"");return Promise.resolve(t.apply(window,i)).then((function(e){return Fn(n,void 0,void 0,(function(){var t;return qn(this,(function(n){switch(n.label){case 0:return t=null,e?[4,(null==e?void 0:e.clone()).text().then((function(e){return e}))]:[3,2];case 1:t=n.sent(),n.label=2;case 2:return[2,{resp:e,body:t}]}}))}))})).then((function(t){var n;if(a){var i=null===(n=null==t?void 0:t.resp)||void 0===n?void 0:n.clone();return i||(i=new Response),i._lsid=a,i.size=Vn(null==t?void 0:t.body),i.responseType="text",i.responseText=null==t?void 0:t.body,e.onComplete(i,me.NET_LOG,"fetch"),null==t?void 0:t.resp}})).catch((function(t){if(a){var n=new Response;n._lsid=a,n.size=0,n.responseText="",e.onComplete(n,me.NET_ERROR,"fetch")}}))}}if(window.XMLHttpRequest&&this.hooks.CanBind(window.XMLHttpRequest.prototype,"open")){var n=this;this.watchedEvents.setRequestHeader=this.hooks.Create(window.XMLHttpRequest.prototype,"setRequestHeader",{before:function(e,t){n.addHeader(this,e,t)}}),this.watchedEvents.open=this.hooks.Create(window.XMLHttpRequest.prototype,"open",{before:function(e,t){var i=this;n.logIsAllow(t).allowLog&&(n.addPendingReq(this,e,t)&&(this.addEventListener("error",(function(){n.onComplete(i,me.NET_ERROR,"xhr")})),this.addEventListener("load",(function(){n.onComplete(i,me.NET_LOG,"xhr")}))))}}),this.watchedEvents.send=this.hooks.Create(window.XMLHttpRequest.prototype,"send",{before:function(e){e&&(null==this?void 0:this._lsid)&&n.pendingReqs[this._lsid]&&(n.pendingReqs[this._lsid].request.body=n.getRequestBody({body:e}))}})}},t.prototype.Register=function(){var e=this;this.NetErrorCounter=0,this.NetLogCounter=0,this.logReached=!1,this.errReached=!1,this.globalEvents.once("api.session.inited",(function(t){var n=t.settings,i=n.networkAllowList;e.inited=!0,e.enabled=n.networkLogs,e.networkAllowList=(null==i?void 0:i.list)||[],e.enabled&&e.HandleRequests(),e.enabled?e.buff.length&&(u()(e.buff,(function(t){var n;if(e.logIsAllow(null===(n=null==t?void 0:t.json_data)||void 0===n?void 0:n.url).allowLog){if(e.isMax(t.type,e.maxErrorsPerPage))return null;e.eventsStream.Add(t.type,t.obj,t.time)}})),e.buff=[]):e.buff=[]}))},t.prototype.getResponseBody=function(e){var t="";try{switch(e.responseType){case"arraybuffer":t=this.ab2str(null==e?void 0:e.response);case"json":case"blob":t=null==e?void 0:e.response;break;case"document":t=null==e?void 0:e.responseXML;break;case"text":case"":t=null==e?void 0:e.responseText;break;default:t=""}}catch(e){t="LiveSession: Error accessing response. ".concat(e)}return t.length>this.maxBodyLength&&(t="".concat(t.slice(0,this.maxBodyLength)," [...]")),null==t?void 0:t.toString()},t.prototype.getResponseLength=function(e){var t=0;try{switch(e.responseType){case"json":case"arraybuffer":case"blob":t=e.response?Vn(null==e?void 0:e.response):0;break;case"document":t=e.responseXML?Vn(null==e?void 0:e.responseXML):0;break;case"text":case"":t=(null==e?void 0:e.responseText)?Vn(null==e?void 0:e.responseText):0;break;default:t=0}}catch(e){console.error("getResponseLength: ".concat(e))}return t},t.prototype.getRequestBody=function(e){if(!e)return null;var t="";try{(null==e?void 0:e.body)&&(t=e.body)}catch(e){t="LiveSession: Error accessing request."}return t.length>this.maxBodyLength&&(t="".concat(t.slice(0,this.maxBodyLength)," [...]")),t},t.prototype.genRequestID=function(){return this.utils.UUID()},t.prototype.onComplete=function(e,t,n){var i=e._lsid;if(i&&this.pendingReqs[i]){var r={};e instanceof XMLHttpRequest&&(r=this.mapResponseXHR(e)),e instanceof Response&&(r=this.mapResponseFETCH(e)),this.pendingReqs[i]=Un(Un({},this.pendingReqs[i]),{status:e.status,time:Date.now()-this.pendingReqs[i].startTime,response:r});var o=this.pendingReqs[i];o.type=n,t===me.NET_ERROR&&(o.status=0),o.status>=400&&(t=me.NET_ERROR),o.request.headers=this.filterHeaders(o.request.headers),o.response.headers=this.filterHeaders(o.response.headers),o.url=jn(o.url);var s=this.logIsAllow(o.url),a=s.allowLog,l=s.allowLogRequestBody,u=s.allowLogResponseBody;a&&(!l&&o.request.body&&(o.request.bodyExists=!!o.request.body,o.request.body=this.mask),!u&&o.response.body&&(o.response.bodyExists=!!o.response.body,o.response.body=this.mask),this.addEvent(t,{json_data:o})),delete this.pendingReqs[i]}},t.prototype.mapResponseFETCH=function(e){var t=this.getResponseBody(e),n=e.size,i={};return e.headers.forEach((function(e,t){return i[t]=e})),{headers:i,length:n,body:t}},t.prototype.mapResponseXHR=function(e){return{headers:this.mapHeaders(e.getAllResponseHeaders()),length:this.getResponseLength(e),body:this.getResponseBody(e)}},t.prototype.mapHeaders=function(e){return e.split(/[\r\n]+/).reduce((function(e,t){var n=e,i=t.split(": ");if(i.length>1){var r=i.shift(),o=i.join(": ");e[r]?n[r]+=", "+o:n[r]=o}return n}),{})},t.prototype.addHeader=function(e,t,n){var i=e._lsid;i&&this.pendingReqs[i]&&(this.pendingReqs[i].request.headers[t]=n)},t.prototype.addPendingReq=function(e,t,n){var i=e._lsid;return i&&delete this.pendingReqs[i],i=this.genRequestID(),this.pendingReqs[i]={id:i,request:{_lsid:i,headers:(null==e?void 0:e.headers)?null==e?void 0:e.headers:{},body:this.getRequestBody(e)},method:t&&t.toUpperCase(),url:n,startTime:Date.now()},e._lsid=i,i},t.prototype.addEvent=function(e,t){var n=this.utils.Time.Duration();if(this.enabled){if(this.isMax(e,this.maxErrorsPerPage))return null;this.eventsStream.Add(e,t,t.startTime,n)}this.inited||this.buff.push({type:e,obj:t,time:n})},t.prototype.Unregister=function(){this.watchedEvents.open&&this.hooks.Unbind(this.watchedEvents.open),this.watchedEvents.setRequestHeader&&this.hooks.Unbind(this.watchedEvents.setRequestHeader)},t.prototype.isMax=function(e,t){return this["".concat(e,"Counter")]>=t?(this["".concat(e,"Reached")]||(this["".concat(e,"Reached")]=!0,this.addEvent(me.NET_LOG,{value:"internal",json_data:{value:"tracking.network.maxLogs.".concat(e)}})),!0):(this["".concat(e,"Counter")]++,!1)},t.prototype.open=function(e,t){console.warn({method:e,url:t})},t}(oe),Xn=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),zn=function(e,t,n){if(n||2===arguments.length)for(var i,r=0,o=t.length;r<o;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},Yn=function(e){function t(t,n,i){var r=e.call(this)||this;return r.hooks=t,r.utils=n,r.eventStream=i,r.nextId=1,r.animationsMap=new WeakMap,r.processAnimation=r.processAnimation.bind(r),r.animationMethodCalledEvent=r.animationMethodCalledEvent.bind(r),r}return Xn(t,e),t.prototype.Register=function(){this.addAnimationHook()},t.prototype.Unregister=function(){this.removeAnimationHook(),this.nextId=0,this.animationsMap=new WeakMap},t.prototype.addAnimationHook=function(){var e=[window.Element.prototype,"animate"],t=e[0],n=e[1];if(this.hooks.CanBind(t,n)){var i=this;this.currentHook=this.hooks.Create(t,n,{afterAsync:function(){var e=this;j((function(){var t=e;i.onNodeAnimate(t)}))}})}},t.prototype.removeAnimationHook=function(){this.currentHook&&this.currentHook.Unbind()},t.prototype.onNodeAnimate=function(e){var t=this;e.getAnimations().forEach((function(n){return t.processAnimation(e,n)}))},t.prototype.processAnimation=function(e,t){var n=this.utils.DOM.GetNodeID(e);if(n){var i=this.animationsMap.has(t),r=0;i?r=this.animationsMap.get(t):(r=this.nextId,this.animationCreatedEvent(n,this.nextId),this.animationsMap.set(t,this.nextId),this.nextId++);var o=Kn.getKeyFrameEffect(t),s=o&&this.animationsMap.has(o);switch(o&&!s&&(this.keyFrameEffectCreatedEvent(n,o,r,this.nextId),this.animationsMap.set(o,this.nextId),this.nextId++),t.playState){case"finished":this.animationMethodCalledEvent(n,r,"finish");break;case"paused":this.animationMethodCalledEvent(n,r,"pause");break;case"running":this.animationMethodCalledEvent(n,r,"play")}if(!i)new Kn(t,r,this.utils,this.animationMethodCalledEvent).addEventListeners()}},t.prototype.animationCreatedEvent=function(e,t){var n={lsid:e,t:1,i:t};this.eventStream.Add(this.name,{json_data:n})},t.prototype.animationMethodCalledEvent=function(e,t,n){var i={lsid:e,t:2,ai:t,m:n};this.eventStream.Add(this.name,{json_data:i})},t.prototype.keyFrameEffectCreatedEvent=function(e,t,n,i){var r={lsid:e,t:3,d:$n.create(t),i:i,ai:n};this.eventStream.Add(this.name,{json_data:r})},t}(oe),Kn=function(){function e(e,t,n,i){this.anim=e,this.id=t,this.utils=n,this.onListener=i,this.onFinish=this.onFinish.bind(this),this.onCancel=this.onCancel.bind(this),this.onRemove=this.onRemove.bind(this)}return e.prototype.addEventListeners=function(){this.anim.addEventListener("finish",this.onFinish),this.anim.addEventListener("cancel",this.onCancel),this.anim.addEventListener("remove",this.onRemove)},e.getKeyFrameEffect=function(e){return e.effect&&e.effect instanceof KeyframeEffect?e.effect:null},e.prototype.removeEventListeners=function(){this.anim.removeEventListener("finish",this.onFinish),this.anim.removeEventListener("cancel",this.onCancel),this.anim.removeEventListener("remove",this.onRemove)},e.prototype.onFinish=function(e){var t=this.getNodeIdFromEvent(e);t&&this.onListener&&this.onListener(t,this.id,"finish")},e.prototype.onCancel=function(e){var t=this.getNodeIdFromEvent(e);t&&this.onListener&&this.onListener(t,this.id,"cancel")},e.prototype.onRemove=function(e){this.getNodeIdFromEvent(e)&&this.onListener&&this.removeEventListeners()},e.prototype.getNodeIdFromEvent=function(e){var t=e.target;if(t){var n=t.effect;if(n){var i=n.target;if(i){var r=this.utils.DOM.GetNodeID(i);if(r)return r;!function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];V.apply(void 0,zn(["animations"],e,!1))}("node id not found from event")}}}},e}(),$n=function(){function e(e,t,n,i){this.frames=e,this.timing=t,this.iterationComposite=n,this.composite=i}return e.create=function(e){var t=e.getKeyframes(),n=e.getTiming();return{frames:t.map((function(e){var t={};for(var n in e){if(["computedOffset"].includes(n))break;var i=e[n];t[n]=i}return t})),timing:{delay:n.delay,direction:n.direction,duration:n.duration,easing:n.easing,endDelay:n.endDelay,fill:n.fill,iterationStart:n.iterationStart,iterations:n.iterations},iterationComposite:e.iterationComposite,composite:e.composite}},e}(),Jn=function(){return Jn=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},Jn.apply(this,arguments)},Qn=function(e,t,n){if(n||2===arguments.length)for(var i,r=0,o=t.length;r<o;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},Zn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];V.apply(void 0,Qn(["Recorder"],e,!1))},ei=function(){function e(e){var t=e.showScriptValidationMessage;Zn("version",1666189088),this.isSessionInited=!1,this.showScriptValidationMessage=t,this.timeoutID=-1,this.JSAPI={init:this.init.bind(this),setOptions:this.setOptions.bind(this),newPageView:this.newPageView.bind(this),identify:this.identify.bind(this),track:this.track.bind(this),setCustomParams:this.identify.bind(this),invalidateSession:this.invalidateSession.bind(this),off:this.off.bind(this),optOut:this.optOut.bind(this),getSessionURL:this.getSessionURL.bind(this),getVisitorID:this.getVisitorID.bind(this),debug:this.debug.bind(this),log:this.log.bind(this)};var n=new yt,i=new Bt,r=new At({utils:n,options:i}),o=new Dt({utils:n,options:i}),s=new Mt({utils:n}),a=new Gt,l=new B({utils:n}),u=new $({options:i,globalEvents:l,visitor:r,pageView:s}),c=new Y({globalEvents:l}),h=new Nt({utils:n}),d=new Et({conditions:c,utils:n,activity:h}),f=new xt({eventsStream:d,transport:u,globalEvents:l,activity:h,pageView:s}),p=new Ht({account:o}),v=new Qt({globalEvents:l});v.Register("intercom",new an({maxAttemps:30,utils:n,globalEvents:l,xhrTransport:u,visitor:r,JSAPI:this.JSAPI})),v.Register("livechat",new xn({maxAttemps:30,utils:n,globalEvents:l,xhrTransport:u,options:i,visitor:r,JSAPI:this.JSAPI}));var m=new he({utils:n,eventsStream:d,aquireInterval:125}),g=new Jt({utils:n,eventsStream:d,aquireInterval:125}),y=new Le({utils:n,eventsStream:d,aquireInterval:500}),b=new Xt({utils:n,options:i,eventsStream:d,globalEvents:l,aquireInterval:500}),w=new zt({utils:n,options:i,eventsStream:d,globalEvents:l});p.Register(me.MUTATION,new st({utils:n,eventsStream:d,globalEvents:l,inputWatcher:b,formWatcher:w,hooks:a,aquireInterval:200,pageView:s,handlers:p})),p.Register(me.LOCATION_CHANGE,new ut({utils:n,eventsStream:d,hooks:a,aquireInterval:500})),p.Register(me.MOUSE_MOVE,m),p.Register(me.TOUCH_MOVE,g),p.Register(me.MOUSE_DOWN,new ve({utils:n,eventsStream:d})),p.Register(me.MOUSE_UP,new fe({utils:n,eventsStream:d})),p.Register(me.MOUSE_DOUBLE_CLICK,new xe({utils:n,eventsStream:d})),p.Register(me.WINDOW_RESIZE,new Ne({utils:n,eventsStream:d,aquireInterval:500})),p.Register(me.WINDOW_SCROLL,y),p.Register(me.SELECTION,new ht({utils:n,eventsStream:d,globalEvents:l,aquireInterval:300})),p.Register(me.SCROLL,new ft({utils:n,eventsStream:d,globalEvents:l,aquireInterval:300})),p.Register(me.CSS_CHANGE,new qt({utils:n,eventsStream:d,globalEvents:l,hooks:a,throttleMax:1024,throttleInterval:1e4})),p.Register(me.MOUSE_CLICK,new Ie({utils:n,eventsStream:d,mouseMoveHandler:m,touchMoveHandler:g,windowScrollHandler:y})),p.Register(me.LOG,new dn({utils:n,eventsStream:d,globalEvents:l,logsLimitPerPage:256,hooks:a})),p.Register(me.PERFORMANCE,new Tn({eventsStream:d})),p.Register(me.TECHNOLOGY,new Pn(d)),p.Register(me.XHR_ERROR,new Gn({utils:n,eventsStream:d,globalEvents:l,logsLimitPerPage:256,hooks:a})),p.Register(me.ANIMATION,new Yn(a,n,d)),l.on("bundler.stream_overflow",this.onCrash.bind(this)),l.on("api.session.expired",this.onSessionExpired.bind(this)),l.on("api.session.malformed_data",this.onMalformedData.bind(this)),l.on("api.session.inited",this.onSessionInited.bind(this)),l.on("api.response.turn_off",this.off.bind(this)),l.on("handlers.".concat(me.MUTATION,".inited"),this.onPageContentReceived.bind(this)),this.integrations=v,this.conditions=c,this.globalEvents=l,this.eventsStream=d,this.utils=n,this.bundler=f,this.visitor=r,this.account=o,this.connection=u,this.pageView=s,this.handlers=p,this.options=i,this.identityData=null,this.newPageViewData=null,this.recordingRules=[{type:"event",name:ke}],this.scanTechnologies=!1}return e.prototype.init=function(e,t){void 0===e&&(e=""),void 0===t&&(t={keystrokes:!1});var n=e.split(".");this.setOptions(Jn(Jn({},t),{accountID:n[0],websiteID:n[1]}))},e.prototype.createMessage=function(e){var t,n=function(e){return e?'<span style="margin-right: 6px!important;color: green!important;font-size: 13px!important;">✓</span>':'<span style="margin-right: 6px!important;color: red!important;font-size: 13px!important;">✘</span>'},i=document.createElement("div");null===(t=null===document||void 0===document?void 0:document.querySelector("body"))||void 0===t||t.appendChild(i),i.outerHTML='<div style="\n        margin: 30px!important;\n        position: fixed!important;\n        z-index:9999999999!important;\n        top:0!important;\n        left:0!important;\n        background-color:#ffe478!important;\n        padding: 12px 16px!important;\n        box-shadow: 4px 3px 11px  #000!important;\n        font-size: 14px!important;\n        border-radius: 4px!important;\n        color:#222!important;\n        font-family: sans-serif!important;\n        "><strong>LiveSession</strong> script status:\n        <ul style="padding:0; margin: 8px 0 0 0; list-style-type: none;"> \n        <li>'.concat(n(e.trackCodeValid)," Track ID (").concat(e.trackId,") </li> \n        <li>").concat(n(e.recordingEnabledValid)," Recording enabled ").concat(e.error_message?" (".concat(e.error_message,")"):""," </li>        \n        </ul></div>")},e.prototype.displayTrackCodeMessage=function(e){var t={trackId:"".concat(this.options.AccountID(),".").concat(this.options.WebsiteID()),trackCodeValid:"Invalid websiteID"!==e&&"Account not exists"!==e,recordingEnabledValid:void 0===e,error_message:e};this.createMessage(t)},e.prototype.invalidateSession=function(){this.visitor.InvalidateSession()},e.prototype.getVisitorID=function(e){var t=this;this.afterSessionIsInited((function(){return e(t.visitor.ID())}),null)},e.prototype.getSessionURL=function(e){var t=this;this.afterSessionIsInited((function(){var n=t.pageView.IsNewSession();return e("".concat("https://app.livesession.io","/app/sessions/").concat(t.visitor.ID(),"/").concat(t.visitor.SessionID()),n)}),null)},e.prototype.identify=function(e){var t=this,n=!1;u()(e,(function(e,i){n||(["name","email","params"].indexOf(i)<0?H("identify object contains invalid property: `"+i+"`"):"params"!=i?t.identityData&&t.identityData[i]&&t.identityData[i]==e||(n=!0):u()(e,(function(e,i){t.identityData&&t.identityData.params&&t.identityData.params[i]==e||(n=!0)})))})),n?(this.identityData?this.identityData=Jn(Jn({},this.identityData),e):this.identityData=e,this.afterSessionIsInited((function(){t.updateData(e)}),"update-data")):Zn("Skipping update_data:","no difference")},e.prototype.track=function(e,t){var n;e="string"==typeof e?e:"";var i,r=In(t=(n=t)&&!Array.isArray(n)&&"object"===h(n)&&n instanceof Object?t:{}),o=r[0],s=r[1];s?console.error(s):this.eventsStream.Add(me.CUSTOM,{value:(i=e,i.slice(0,256)),json_data:o})},e.prototype.afterSessionIsInited=function(e,t){if(this.isSessionInited)return e();this.globalEvents.once("api.session.inited",e,t)},e.prototype.optOut=function(){a.set("__ls_optout","1",{expires:Number.MAX_SAFE_INTEGER}),this.off()},e.prototype.debug=function(e){void 0===e&&(e=!0),window.__ls_debug=e},e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this.handlers.Get(me.LOG),i=e;if(n){var r="log";"string"==typeof i||i.length>0&&(be[i[0]]&&(r=i[0],i.shift()),n.Console(r,i))}else console.warn("[LS] consoleHandler not found on log func")},e.prototype.transport=function(){return this.connection},e.prototype.setOptions=function(e){void 0===e&&(e={accountID:null,websiteID:null,keystrokes:null,rootHostname:null});var t=e.accountID,n=e.websiteID,i=e.keystrokes,r=e.rootHostname;t&&this.options.SetAccountID(t),n&&this.options.SetWebsiteID(n),null!==i&&this.options.Set("keystrokes",i),null!==r&&this.options.Set("rootHostname",r)},e.prototype.onCrash=function(){this.off()},e.prototype.off=function(){this.eventsStream.Clear(),this.handlers.CleanUp(),Zn("Turned off.")},e.prototype.onSessionExpired=function(){this.newPageView()},e.prototype.onMalformedData=function(){this.invalidateSession(),this.newPageView()},e.prototype.onPageContentReceived=function(e,t){this.onConfigReceived(t)},e.prototype.onConfigReceived=function(e){var t=this;-1!=this.timeoutID&&(clearTimeout(this.timeoutID),this.timeoutID=-1);var n=this.account.settings.minTimeOnPage;n>0&&!this.visitor.IsValid()?this.timeoutID=setTimeout((function(){t.sendPageView(e,n)}),1e3*n):this.sendPageView(e)},e.prototype.onSessionInited=function(e){e.isNew;this.scanTechnologies&&this.handlers.Get(me.TECHNOLOGY).Init(),this.identityData&&this.updateData(this.identityData)},e.prototype.newPageView=function(e){var t=this;void 0===e&&(e={}),this.newPageViewData=e,this.pageView.SetPageViewOptions(e),this.isSessionInited=!1,this.bundler.send(),this.bundler.Reset(),this.bundler.Stop(),this.eventsStream.Clear(),this.eventsStream.Disable(),this.utils.Time.Reset(),this.handlers.CleanUp(),this.initialState=this.handlers.Init(),this.conditions.Restart(e.conditions||this.recordingRules),this.conditions.Set([{type:"pageView",name:["Init"]}]),this.transport().PageViewInit((function(e){var n=e.scan_technologies,i=e.settings,r=e.integrations;n&&(t.scanTechnologies=!0),t.account.Set(i),t.integrations.SetEnabledList(r),t.integrations.Scan();var o=t.account.Settings().recordingElementsMap;o&&o&&t.utils.DOM.SetRecordingElementsMap(o),t.conditions.CheckPageViewData({name:["Init"]})}),(function(e){var n=e.data||e;Zn("init() error:",n),t.showScriptValidationMessage&&t.displayTrackCodeMessage(null==n?void 0:n.msg)})),this.globalEvents.once("conditions.fulfilled",(function(){t.utils.Time.Reset(),t.visitor.Load(),t.eventsStream.Enable(),t.initialState=t.handlers.Init(),t.handlers.Get(me.LOCATION_CHANGE).Handler({force:!0}),t.handlers.Get(me.MUTATION).Init(),t.handlers.Get(me.CSS_CHANGE).Init(),t.handlers.Get(me.PERFORMANCE).Init()}),"new-page-view-conditions-fulfilled")},e.prototype.sendPageView=function(e,t){var n=this,i=this.pageView.GetPageViewInfo(this.newPageViewData),r={events:this.eventsStream.All()};this.transport().SendPageView(Jn(Jn({},i),{script_version:1666189088,script_timestamp_version:1666189088,script_tag_version:c.i8,page_view:Jn(Jn({},i.page_view),{page:Jn(Jn({},i.page_view.page),{body:JSON.stringify(e)}),initial_events:this.initialState,script_timestamp_version:1666189088,script_tag_version:c.i8}),visitor_side_storage:this.visitor.JSON(),time_offset:t,bundle:r}),this.pageViewInited.bind(this),(function(e){Zn("SendPageView() error:",e.data),n.showScriptValidationMessage&&n.displayTrackCodeMessage(null==e?void 0:e.message)}))},e.prototype.pageViewInited=function(e){var t=e.page_view_id,n=e.creation_timestamp,i=e.new_session,r=e.visitor_side_storage,o=r.ls_sid,s=r.ls_vid,a=r.ls_sexp,l=r.ls_clsid;this.visitor.Set(s,o,a,l),this.pageView.SetID(t),n&&this.pageView.SetCreationTimestamp(n),this.pageView.SetSessionState(i),this.integrations.Scan(),this.bundler.Start(),this.isSessionInited=!0,this.globalEvents.call("api.session.inited",{isNew:i,settings:this.account.Settings()}),this.account.Settings().networkLogs&&(P.enabled=!0),this.showScriptValidationMessage&&this.displayTrackCodeMessage()},e.prototype.updateData=function(e){var t=e.name,n=e.email,i=e.params,r={};t&&(r.name=t),n&&(r.email=n),i&&(r.params=f(i,(function(e,t){return{name:t,value:e+""}}))),this.eventsStream.Add(me.IDENTIFY,{json_data:r})},e}(),ti=function(){return window.__ls_namespace||"__ls"};!function(e,t){!function(e,t){var n=function(){return j(i)},i=function(){if(void 0!==e.__ls_inited)return V("API","Already inited."),!0;if(/bot|googlebot|crawler|spider|robot|crawling|netlify|PingdomTMS/i.test(navigator.userAgent))return!0;e.__ls_inited=1,e.__ls;var t=1==a.get("__ls_debug")||U("__ls_debug");t&&(e.__ls_debug=t);var n=U("__ls_optout");if(a.get("__ls_optout")||n)return a.set("__ls_optout","1",{expires:Number.MAX_SAFE_INTEGER}),V("API","Recording disabled."),!0;if(U("__ls_off"))return V("API","Recording disabled."),!0;var i=!!U("__ls_validation");e.__lsRecorder=new ei({showScriptValidationMessage:i});var o=e[ti()]&&(e[ti()].store||e.__lsStore);if(e[ti()]=function(){if(arguments){var t=Array.prototype.slice.call(arguments),n=e.__lsRecorder.JSAPI[t[0]];if(n)return j((function(){n.apply(e.__lsRecorder,t.splice(1))}));console.warn("[LS] Undefined function call: "+t[0])}},o){for(var s=0,l=o.length;s<l;s++)e[ti()].apply(e,r(o[s]));e.__lsStore=e[ti()].store=void 0}};setTimeout(n,500),"complete"!=t.readyState?e.attachEvent?e.attachEvent("onload",n):e.addEventListener("load",n,!1):n()}(e,t)}(window,document)}()}();
//# sourceMappingURL=~/track.js.map